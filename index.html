import React, { useState, useEffect, useRef } from 'react';
import { 
  BookOpen, 
  Type, 
  PenTool, 
  AlignLeft, 
  Map, 
  ChevronRight, 
  ChevronLeft, 
  RotateCcw,
  CheckCircle2,
  XCircle,
  Lightbulb,
  Search,
  CalendarDays,
  MessageCircle,
  Send,
  Loader2,
  Bot,
  Sparkles,
  X,
  Trophy,
  CheckCircle,
  ChevronDown,
  ChevronUp,
  CheckSquare,
  Square
} from 'lucide-react';

// --- DATA CẤP NHẬT TỪ CÁC FILE PDF ---

const vocabData = [
  { kanji: "本物", kana: "ほんもの", meaning: "hàng thật, đồ thật", type: "Danh từ" },
  { kanji: "彼", kana: "かれ", meaning: "anh ấy, bạn trai", type: "Danh từ" },
  { kanji: "台風", kana: "たいふう", meaning: "cơn bão", type: "Danh từ" },
  { kanji: "洗濯物", kana: "せんたくもの", meaning: "đồ bẩn cần giặt", type: "Danh từ" },
  { kanji: "遊園地", kana: "ゆうえんち", meaning: "khu giải trí", type: "Danh từ" },
  { kanji: "ハイキング", kana: "ハイキング", meaning: "leo núi dã ngoại", type: "Danh từ" },
  { kanji: "厳しい", kana: "きびしい", meaning: "nghiêm khắc, khắt khe", type: "Tính từ đuôi い" },
  { kanji: "混む", kana: "こむ", meaning: "đông đúc, chen lấn", type: "Động từ" },
  { kanji: "上がる", kana: "あがる", meaning: "leo lên; tăng lên", type: "Động từ" },
  { kanji: "下がる", kana: "さがる", meaning: "giảm xuống; hạ xuống", type: "Động từ" },
  { kanji: "乾く", kana: "かわく", meaning: "khô (quần áo, không khí...)", type: "Động từ" },
  { kanji: "止む", kana: "やむ", meaning: "dừng; tạnh (mưa)", type: "Động từ" },
  { kanji: "叶う", kana: "かなう", meaning: "(ước mơ) thành hiện thực", type: "Động từ" },
  { kanji: "楽しむ", kana: "たのしむ", meaning: "tận hưởng; mong chờ", type: "Động từ" },
  { kanji: "返す", kana: "かえす", meaning: "trả lại", type: "Động từ" },
  { kanji: "中止", kana: "ちゅうし", meaning: "dừng, hoãn", type: "Danh từ / Động từ" },
  { kanji: "成功", kana: "せいこう", meaning: "thành công", type: "Danh từ / Động từ" },
  { kanji: "失敗", kana: "しっぱい", meaning: "thất bại", type: "Danh từ / Động từ" },
  { kanji: "きっと", kana: "きっと", meaning: "nhất định, chắc chắn", type: "Phó từ" },
  { kanji: "ただいま", kana: "ただいま", meaning: "Tôi đã về rồi đây", type: "Mẫu câu" },
  { kanji: "おかえりなさい", kana: "おかえりなさい", meaning: "Bạn đã về rồi đấy à", type: "Mẫu câu" },
  { kanji: "風邪", kana: "かぜ", meaning: "cảm lạnh, cảm cúm", type: "Danh từ" },
  { kanji: "救急車", kana: "きゅうきゅうしゃ", meaning: "xe cấp cứu", type: "Danh từ" },
  { kanji: "事故", kana: "じこ", meaning: "tai nạn", type: "Danh từ" },
  { kanji: "雷", kana: "かみなり", meaning: "sấm sét", type: "Danh từ" },
  { kanji: "留守", kana: "るす", meaning: "vắng nhà", type: "Danh từ" },
  { kanji: "旅館", kana: "りょかん", meaning: "lữ quán, nhà trọ kiểu Nhật", type: "Danh từ" },
  { kanji: "旅行客", kana: "りょこうきゃく", meaning: "khách du lịch", type: "Danh từ" },
  { kanji: "入り口", kana: "いりぐち", meaning: "lối vào", type: "Danh từ" },
  { kanji: "有名人", kana: "ゆうめいじん", meaning: "người nổi tiếng", type: "Danh từ" },
  { kanji: "調味料", kana: "ちょうみりょう", meaning: "gia vị", type: "Danh từ" },
  { kanji: "平日", kana: "へいじつ", meaning: "ngày thường", type: "Danh từ" },
  { kanji: "ガソリン", kana: "ガソリン", meaning: "xăng dầu", type: "Danh từ" },
  { kanji: "真っ暗", kana: "まっくら", meaning: "tối om", type: "Tính từ đuôi な" },
  { kanji: "同じ", kana: "おなじ", meaning: "giống, giống nhau", type: "Tính từ" },
  { kanji: "引く", kana: "ひく", meaning: "bị (cảm lạnh), trúng (gió)", type: "Động từ" },
  { kanji: "集まる", kana: "あつまる", meaning: "tập trung", type: "Động từ" },
  { kanji: "差す", kana: "さす", meaning: "giương (ô)", type: "Động từ" },
  { kanji: "届く", kana: "とどく", meaning: "được gửi đến/ đưa đến", type: "Động từ" },
  { kanji: "なくなる", kana: "なくなる", meaning: "mất, biến mất, hết", type: "Động từ" },
  { kanji: "ぶつかる", kana: "ぶつかる", meaning: "va phải, đụng phải", type: "Động từ" },
  { kanji: "できる", kana: "できる", meaning: "hoàn thành", type: "Động từ" },
  { kanji: "怪我", kana: "けが", meaning: "bị thương", type: "Danh từ / Động từ" },
  { kanji: "すぐに", kana: "すぐに", meaning: "ngay lập tức, lập tức", type: "Phó từ" },
  { kanji: "だいぶ", kana: "だいぶ", meaning: "khá là, đáng kể", type: "Phó từ" },
  { kanji: "もしかしたら", kana: "もしかしたら", meaning: "có lẽ", type: "Phó từ" },
  { kanji: "お花見", kana: "おはなみ", meaning: "sự ngắm hoa", type: "Danh từ" },
  { kanji: "最初", kana: "さいしょ", meaning: "đầu tiên", type: "Danh từ / Phó từ" },
  { kanji: "今週末", kana: "こんしゅうまつ", meaning: "cuối tuần này", type: "Danh từ" },
  { kanji: "地震", kana: "じしん", meaning: "động đất", type: "Danh từ" },
  { kanji: "昼寝", kana: "ひるね", meaning: "ngủ trưa", type: "Danh từ" },
  { kanji: "うそ", kana: "うそ", meaning: "lời nói dối", type: "Danh từ" },
  { kanji: "赤ちゃん", kana: "あかちゃん", meaning: "em bé, trẻ sơ sinh", type: "Danh từ" },
  { kanji: "火事", kana: "かじ", meaning: "hoả hoạn", type: "Danh từ" },
  { kanji: "教科書", kana: "きょうかしょ", meaning: "sách giáo khoa", type: "Danh từ" },
  { kanji: "イギリス", kana: "イギリス", meaning: "nước Anh", type: "Danh từ" },
  { kanji: "オリンピック", kana: "オリンピック", meaning: "thế vận hội Olympic", type: "Danh từ" },
  { kanji: "ボーナス", kana: "ボーナス", meaning: "tiền thưởng, phần thưởng", type: "Danh từ" },
  { kanji: "羨ましい", kana: "うらやましい", meaning: "ngưỡng mộ, ghen tị", type: "Tính từ đuôi い" },
  { kanji: "勝つ", kana: "かつ", meaning: "thắng, chiến thắng", type: "Động từ" },
  { kanji: "誘う", kana: "さそう", meaning: "rủ, mời (ai đó)", type: "Động từ" },
  { kanji: "亡くなる", kana: "なくなる", meaning: "mất, qua đời", type: "Động từ" },
  { kanji: "別れる", kana: "わかれる", meaning: "chia tay", type: "Động từ" },
  { kanji: "負ける", kana: "まける", meaning: "thua, bại trận", type: "Động từ" },
  { kanji: "売れる", kana: "うれる", meaning: "bán đắt hàng, bán chạy", type: "Động từ" },
  { kanji: "生まれる", kana: "うまれる", meaning: "được sinh ra", type: "Động từ" },
  { kanji: "辞める", kana: "やめる", meaning: "từ bỏ; nghỉ (việc), bỏ (học)", type: "Động từ" },
  { kanji: "優勝", kana: "ゆうしょう", meaning: "vô địch", type: "Danh từ / Động từ" },
  { kanji: "びっくり", kana: "びっくり", meaning: "giật mình", type: "Danh từ / Động từ" },
  { kanji: "しかも", kana: "しかも", meaning: "hơn nữa", type: "Phó từ" },
  { kanji: "まじで", kana: "まじで", meaning: "Thật á? Thật sao?", type: "Mẫu câu" },
  { kanji: "やばい", kana: "やばい", meaning: "Chết rồi!", type: "Mẫu câu" },
  { kanji: "エイプリル・フール", kana: "エイプリル・フール", meaning: "Ngày Cá tháng Tư", type: "Danh từ" },
  { kanji: "お礼", kana: "おれい", meaning: "lời/ quà cảm ơn", type: "Danh từ" },
  { kanji: "用事", kana: "ようじ", meaning: "việc bận", type: "Danh từ" },
  { kanji: "電池", kana: "でんち", meaning: "cục pin", type: "Danh từ" },
  { kanji: "天気予報", kana: "てんきよほう", meaning: "dự báo thời tiết", type: "Danh từ" },
  { kanji: "交通", kana: "こうつう", meaning: "giao thông", type: "Danh từ" },
  { kanji: "形", kana: "かたち", meaning: "hình dáng", type: "Danh từ" },
  { kanji: "将来", kana: "しょうらい", meaning: "tương lai", type: "Danh từ / Phó từ" },
  { kanji: "痛い", kana: "いたい", meaning: "đau, đau đớn", type: "Tính từ đuôi い" },
  { kanji: "危ない", kana: "あぶない", meaning: "nguy hiểm", type: "Tính từ đuôi い" },
  { kanji: "引っ越す", kana: "ひっこす", meaning: "chuyển nhà", type: "Động từ" },
  { kanji: "おすすめ", kana: "おすすめ", meaning: "giới thiệu, đề xuất", type: "Danh từ / Động từ" },
  { kanji: "こうやって", kana: "こうやって", meaning: "làm như thế này", type: "Phó từ" },
  { kanji: "興味", kana: "きょうみ", meaning: "hứng thú", type: "Danh từ" },
  { kanji: "意味", kana: "いみ", meaning: "ý nghĩa", type: "Danh từ" },
  { kanji: "場所", kana: "ばしょ", meaning: "địa điểm, nơi", type: "Danh từ" },
  { kanji: "知り合い", kana: "しりあい", meaning: "người quen", type: "Danh từ" },
  { kanji: "選手", kana: "せんしゅ", meaning: "tuyển thủ", type: "Danh từ" },
  { kanji: "調子", kana: "ちょうし", meaning: "tình trạng", type: "Danh từ" },
  { kanji: "ミュージカル", kana: "ミュージカル", meaning: "nhạc kịch", type: "Danh từ" },
  { kanji: "チャット", kana: "チャット", meaning: "chat, tán gẫu", type: "Danh từ" },
  { kanji: "遠い", kana: "とおい", meaning: "xa", type: "Tính từ đuôi い" },
  { kanji: "よろしい", kana: "よろしい", meaning: "được, tốt (lịch sự)", type: "Tính từ đuôi い" },
  { kanji: "苦い", kana: "にがい", meaning: "(vị) đắng", type: "Tính từ đuôi い" },
  { kanji: "大きな", kana: "おおきな", meaning: "to, lớn", type: "Tính từ" },
  { kanji: "似合う", kana: "にあう", meaning: "hợp với ~", type: "Động từ" },
  { kanji: "始める", kana: "はじめる", meaning: "bắt đầu", type: "Động từ" },
  { kanji: "注文", kana: "ちゅうもん", meaning: "gọi món, đặt mua", type: "Danh từ / Động từ" },
  { kanji: "確か", kana: "たしか", meaning: "hình như, nếu không nhầm thì", type: "Phó từ" },
  { kanji: "お大事に", kana: "おだいじに", meaning: "hãy chú ý giữ gìn sức khoẻ", type: "Mẫu câu" },
  { kanji: "実は", kana: "じつは", meaning: "thật ra ~", type: "Mẫu câu" },
  { kanji: "市", kana: "し", meaning: "thành phố", type: "Danh từ" },
  { kanji: "同僚", kana: "どうりょう", meaning: "đồng nghiệp", type: "Danh từ" },
  { kanji: "貿易", kana: "ぼうえき", meaning: "ngoại thương, thương mại", type: "Danh từ" },
  { kanji: "着物", kana: "きもの", meaning: "kimono", type: "Danh từ" },
  { kanji: "具合", kana: "ぐあい", meaning: "tình trạng sức khoẻ", type: "Danh từ" },
  { kanji: "気分", kana: "きぶん", meaning: "tâm trạng", type: "Danh từ" },
  { kanji: "デート", kana: "デート", meaning: "hẹn hò, buổi hẹn", type: "Danh từ" },
  { kanji: "利用", kana: "りよう", meaning: "sử dụng", type: "Danh từ / Động từ" },
  { kanji: "紹介", kana: "しょうかい", meaning: "giới thiệu", type: "Danh từ / Động từ" },
  { kanji: "カット", kana: "カット", meaning: "cắt, chia", type: "Danh từ / Động từ" },
  { kanji: "なんで", kana: "なんで", meaning: "tại sao", type: "Phó từ" },
  { kanji: "だから", kana: "だから", meaning: "bởi vậy, vậy nên", type: "Liên từ" },
  { kanji: "どうやって", kana: "どうやって", meaning: "làm thế nào ~", type: "Mẫu câu" },
  { kanji: "砂", kana: "すな", meaning: "cát", type: "Danh từ" },
  { kanji: "(お)風呂", kana: "(お)ふろ", meaning: "bồn tắm", type: "Danh từ" },
  { kanji: "敬語", kana: "けいご", meaning: "kính ngữ", type: "Danh từ" },
  { kanji: "ひも", kana: "ひも", meaning: "sợi dây", type: "Danh từ" },
  { kanji: "コンセント", kana: "コンセント", meaning: "ổ cắm", type: "Danh từ" },
  { kanji: "うれしい", kana: "うれしい", meaning: "vui vẻ", type: "Tính từ đuôi い" },
  { kanji: "強い", kana: "つよい", meaning: "mạnh, mạnh mẽ", type: "Tính từ đuôi い" },
  { kanji: "弱い", kana: "よわい", meaning: "yếu, yếu đuối", type: "Tính từ đuôi い" },
  { kanji: "優しい", kana: "やさしい", meaning: "tử tế, tốt bụng", type: "Tính từ đuôi い" },
  { kanji: "悲しい", kana: "かなしい", meaning: "buồn bã", type: "Tính từ đuôi い" },
  { kanji: "幸せ", kana: "しあわせ", meaning: "hạnh phúc", type: "Tính từ" },
  { kanji: "真面目", kana: "まじめ", meaning: "nghiêm túc, chăm chỉ", type: "Tính từ" },
  { kanji: "間違える", kana: "まちがえる", meaning: "nhầm, sai", type: "Động từ" },
  { kanji: "切れる", kana: "きれる", meaning: "bị gãy, bị đứt", type: "Động từ" },
  { kanji: "取れる", kana: "とれる", meaning: "bung ra", type: "Động từ" },
  { kanji: "折れる", kana: "おれる", meaning: "gãy", type: "Động từ" },
  { kanji: "消える", kana: "きえる", meaning: "(điện, đèn,...) tắt", type: "Động từ" },
  { kanji: "ゴール", kana: "ゴール", meaning: "ghi bàn, ghi điểm", type: "Danh từ / Động từ" },
  { kanji: "もう少しで", kana: "もうすこしで", meaning: "thêm một chút", type: "Mẫu câu" },
  { kanji: "気持ち", kana: "きもち", meaning: "tâm trạng", type: "Danh từ" },
  { kanji: "前髪", kana: "まえがみ", meaning: "tóc mái", type: "Danh từ" },
  { kanji: "くちびる", kana: "くちびる", meaning: "đôi môi", type: "Danh từ" },
  { kanji: "砂糖", kana: "さとう", meaning: "đường, đường ăn", type: "Danh từ" },
  { kanji: "電気", kana: "でんき", meaning: "điện", type: "Danh từ" },
  { kanji: "牛乳", kana: "ぎゅうにゅう", meaning: "sữa bò", type: "Danh từ" },
  { kanji: "黒板", kana: "こくばん", meaning: "bảng đen", type: "Danh từ" },
  { kanji: "壁", kana: "かべ", meaning: "bức tường", type: "Danh từ" },
  { kanji: "温度", kana: "おんど", meaning: "nhiệt độ", type: "Danh từ" },
  { kanji: "冷房", kana: "れいぼう", meaning: "chế độ lạnh của điều hoà", type: "Danh từ" },
  { kanji: "チラシ", kana: "チラシ", meaning: "tờ rơi quảng cáo", type: "Danh từ" },
  { kanji: "エアコン", kana: "エアコン", meaning: "điều hòa", type: "Danh từ" },
  { kanji: "暗い", kana: "くらい", meaning: "tối, u ám", type: "Tính từ đuôi い" },
  { kanji: "暖かい", kana: "あたたかい", meaning: "ấm", type: "Tính từ đuôi い" },
  { kanji: "薄い", kana: "うすい", meaning: "mỏng, nông", type: "Tính từ đuôi い" },
  { kanji: "厚い", kana: "あつい", meaning: "dày", type: "Tính từ đuôi い" },
  { kanji: "白い", kana: "しろい", meaning: "màu trắng, trắng", type: "Tính từ đuôi い" },
  { kanji: "うるさい", kana: "うるさい", meaning: "ầm ỹ, ồn ào", type: "Tính từ đuôi い" },
  { kanji: "切る", kana: "きる", meaning: "cắt", type: "Động từ" },
  { kanji: "塗る", kana: "ぬる", meaning: "bôi (thuốc), quét (sơn)", type: "Động từ" },
  { kanji: "折る", kana: "おる", meaning: "bẻ, gập", type: "Động từ" },
  { kanji: "冷やす", kana: "ひやす", meaning: "làm lạnh", type: "Động từ" },
  { kanji: "分ける", kana: "わける", meaning: "chia, phân loại", type: "Động từ" },
  { kanji: "換える", kana: "かえる", meaning: "đổi", type: "Động từ" },
  { kanji: "温める", kana: "あたためる", meaning: "làm ấm", type: "Động từ" },
  { kanji: "もっと", kana: "もっと", meaning: "hơn, nữa", type: "Phó từ" },
  { kanji: "なかなか", kana: "なかなか", meaning: "mãi mà (không)", type: "Phó từ" },
  { kanji: "度", kana: "ど", meaning: "độ C", type: "Danh từ" },
  { kanji: "おめでとう", kana: "おめでとう", meaning: "chúc mừng (về ~)", type: "Mẫu câu" },
  { kanji: "比べて", kana: "くらべて", meaning: "So với ~", type: "Mẫu câu" },
  { kanji: "寝室", kana: "しんしつ", meaning: "phòng ngủ", type: "Danh từ" },
  { kanji: "棚", kana: "たな", meaning: "tủ, giá...", type: "Danh từ" },
  { kanji: "パズル", kana: "パズル", meaning: "đồ chơi xếp hình", type: "Danh từ" },
  { kanji: "データ", kana: "データ", meaning: "dữ liệu", type: "Danh từ" },
  { kanji: "タイマー", kana: "タイマー", meaning: "hẹn giờ", type: "Danh từ" },
  { kanji: "アイドル", kana: "アイドル", meaning: "thần tượng", type: "Danh từ" },
  { kanji: "大切", kana: "たいせつ", meaning: "quan trọng", type: "Tính từ" },
  { kanji: "育つ", kana: "そだつ", meaning: "được nuôi nấng", type: "Động từ" },
  { kanji: "暖まる", kana: "あたたまる", meaning: "ấm lên, nóng lên", type: "Động từ" },
  { kanji: "つく", kana: "つく", meaning: "(điện, đèn...) bật", type: "Động từ" },
  { kanji: "沸かす", kana: "わかす", meaning: "làm nóng, đun nóng (bồn tắm, nước ấm)", type: "Động từ" },
  { kanji: "沸く", kana: "わく", meaning: "(nước bồn tắm, nước ấm) sôi lên", type: "Động từ" },
  { kanji: "治る", kana: "なおる", meaning: "khỏi (bệnh, ốm)", type: "Động từ" },
  { kanji: "治す", kana: "なおす", meaning: "chữa khỏi", type: "Động từ" },
  { kanji: "落とす", kana: "おとす", meaning: "làm rơi, đánh rơi", type: "Động từ" },
  { kanji: "汚す", kana: "よごす", meaning: "làm bẩn", type: "Động từ" },
  { kanji: "消す", kana: "けす", meaning: "tắt / xóa", type: "Động từ" },
  { kanji: "乾かす", kana: "かわかす", meaning: "làm khô, hong khô", type: "Động từ" },
  { kanji: "破る", kana: "やぶる", meaning: "làm rách", type: "Động từ" },
  { kanji: "売る", kana: "うる", meaning: "bán", type: "Động từ" },
  { kanji: "壊す", kana: "こわす", meaning: "làm hỏng", type: "Động từ" },
  { kanji: "割る", kana: "わる", meaning: "làm vỡ", type: "Động từ" },
  { kanji: "倒す", kana: "たおす", meaning: "chặt đổ, đốn ngã... đánh gục", type: "Động từ" },
  { kanji: "冷える", kana: "ひえる", meaning: "lạnh", type: "Động từ" },
  { kanji: "捨てる", kana: "すてる", meaning: "vứt", type: "Động từ" },
  { kanji: "助ける", kana: "たすける", meaning: "giúp đỡ, cứu", type: "Động từ" },
  { kanji: "止める", kana: "とめる", meaning: "cản, ngăn, đỗ", type: "Động từ" },
  { kanji: "緊張", kana: "きんちょう", meaning: "căng thẳng", type: "Danh từ / Động từ" },
  { kanji: "結構", kana: "けっこう", meaning: "khá, tương đối", type: "Phó từ" },
  { kanji: "だって", kana: "だって", meaning: "bởi vì...", type: "Liên từ / Phó từ" },
  { kanji: "予定", kana: "よてい", meaning: "dự định, kế hoạch", type: "Danh từ" },
  { kanji: "変わる", kana: "かわる", meaning: "được thay đổi", type: "Động từ" },
  { kanji: "貼る", kana: "はる", meaning: "dán", type: "Động từ" },
  { kanji: "飾る", kana: "かざる", meaning: "trang trí", type: "Động từ" },
  { kanji: "植わる", kana: "うわる", meaning: "được trồng", type: "Động từ" },
  { kanji: "植える", kana: "うえる", meaning: "trồng (cây)", type: "Động từ" },
  { kanji: "並べる", kana: "ならべる", meaning: "sắp xếp", type: "Động từ" },
  { kanji: "変える", kana: "かえる", meaning: "thay đổi, đổi", type: "Động từ" },
  { kanji: "開始", kana: "かいし", meaning: "bắt đầu", type: "Danh từ / Động từ" },
  { kanji: "ちゃんと", kana: "ちゃんと", meaning: "đầy đủ", type: "Phó từ" },
  { kanji: "そのままで", kana: "そのままで", meaning: "Để nguyên, giữ nguyên như thế ~", type: "Mẫu câu" },
  { kanji: "っけ", kana: "っけ", meaning: "~ ấy nhỉ?", type: "Mẫu câu" },
  { kanji: "熱中症", kana: "ねっちゅうしょう", meaning: "say nắng, cảm nắng", type: "Danh từ" },
  { kanji: "逆", kana: "ぎゃく", meaning: "ngược lại", type: "Danh từ" },
  { kanji: "出口", kana: "でぐち", meaning: "lối ra", type: "Danh từ" },
  { kanji: "見合わせ", kana: "みあわせ", meaning: "tạm dừng để quan sát", type: "Danh từ" },
  { kanji: "税込み", kana: "ぜいこみ", meaning: "gồm cả thuế", type: "Danh từ" },
  { kanji: "税抜き", kana: "ぜいぬき", meaning: "không gồm thuế", type: "Danh từ" },
  { kanji: "消費税", kana: "しょうひぜい", meaning: "thuế tiêu thụ", type: "Danh từ" },
  { kanji: "熱い", kana: "あつい", meaning: "nóng (dùng cho cảm giác)", type: "Tính từ đuôi い" },
  { kanji: "安全", kana: "あんぜん", meaning: "an toàn", type: "Tính từ đuôi な" },
  { kanji: "流す", kana: "ながす", meaning: "xả, làm chảy đi", type: "Động từ" },
  { kanji: "近づく", kana: "ちかづく", meaning: "đến gần", type: "Động từ" },
  { kanji: "合う", kana: "あう", meaning: "khớp, đúng", type: "Động từ" },
  { kanji: "逃げる", kana: "にげる", meaning: "chạy trốn", type: "Động từ" },
  { kanji: "火傷", kana: "やけど", meaning: "bị bỏng", type: "Danh từ / Động từ" },
  { kanji: "飲食", kana: "いんしょく", meaning: "ăn uống", type: "Danh từ / Động từ" },
  { kanji: "禁止", kana: "きんし", meaning: "cấm", type: "Danh từ / Động từ" },
  { kanji: "避難", kana: "ひなん", meaning: "lánh nạn, tránh nạn", type: "Danh từ / Động từ" },
  { kanji: "遅延", kana: "ちえん", meaning: "chậm trễ, trì hoãn", type: "Danh từ / Động từ" },
  { kanji: "無理", kana: "むり", meaning: "gắng sức, cố sức", type: "Danh từ / Động từ" },
  { kanji: "わざわざ", kana: "わざわざ", meaning: "cất công", type: "Phó từ" },
  { kanji: "どういう", kana: "どういう", meaning: "như thế nào", type: "Mẫu câu" },
  { kanji: "強い言葉", kana: "つよいことば", meaning: "nặng lời", type: "Cụm từ" },
  { kanji: "ぞ", kana: "ぞ", meaning: "~ đấy! (vĩ tố)", type: "Mẫu câu" },
  { kanji: "男性", kana: "だんせい", meaning: "nam giới", type: "Danh từ" },
  { kanji: "女性", kana: "じょせい", meaning: "nữ giới", type: "Danh từ" },
  { kanji: "伝統的", kana: "でんとうてき", meaning: "tính truyền thống", type: "Tính từ đuôi な" },
  { kanji: "方言", kana: "ほうげん", meaning: "tiếng địa phương", type: "Danh từ" },
  { kanji: "道具", kana: "どうぐ", meaning: "dụng cụ", type: "Danh từ" },
  { kanji: "神社", kana: "じんじゃ", meaning: "ngôi đền", type: "Danh từ" },
  { kanji: "寺", kana: "てら", meaning: "ngôi chùa", type: "Danh từ" },
  { kanji: "しょうゆ", kana: "しょうゆ", meaning: "nước tương shoyu", type: "Danh từ" },
  { kanji: "カレンダー", kana: "カレンダー", meaning: "tờ lịch, lịch", type: "Danh từ" },
  { kanji: "セロテープ", kana: "セロテープ", meaning: "băng dính trong", type: "Danh từ" },
  { kanji: "ソース", kana: "ソース", meaning: "nước xốt", type: "Danh từ" },
  { kanji: "フォーク", kana: "フォーク", meaning: "cái nĩa, dĩa", type: "Danh từ" },
  { kanji: "バンジージャンプ", kana: "バンジージャンプ", meaning: "nhảy bungee", type: "Danh từ" },
  { kanji: "しょっぱい", kana: "しょっぱい", meaning: "mặn", type: "Tính từ đuôi い" },
  { kanji: "検索", kana: "けんさく", meaning: "tìm kiếm, tra cứu", type: "Danh từ / Động từ" },
  { kanji: "ラッピング", kana: "ラッピング", meaning: "bao, gói", type: "Danh từ / Động từ" },
  { kanji: "お祝い", kana: "おいわい", meaning: "chúc mừng", type: "Danh từ / Động từ" },
  { kanji: "感謝", kana: "かんしゃ", meaning: "cảm ơn, biết ơn", type: "Danh từ / Động từ" },
  { kanji: "用", kana: "よう", meaning: "dùng cho/ dành cho ~", type: "Hậu tố" },
  { kanji: "男性用", kana: "だんせいよう", meaning: "dùng cho nam giới", type: "Danh từ" },
  { kanji: "女性用", kana: "じょせいよう", meaning: "dùng cho nữ giới", type: "Danh từ" },
  { kanji: "プレゼント用", kana: "プレゼントよう", meaning: "dùng để làm quà", type: "Danh từ" },
  { kanji: "奥様", kana: "おくさま", meaning: "vợ, phu nhân (người khác)", type: "Danh từ" },
  { kanji: "夫", kana: "おっと", meaning: "chồng (mình)", type: "Danh từ" },
  { kanji: "妻", kana: "つま", meaning: "vợ (mình)", type: "Danh từ" },
  { kanji: "甥", kana: "おい", meaning: "cháu trai (con của anh chị em)", type: "Danh từ" },
  { kanji: "姪", kana: "めい", meaning: "cháu gái (con của anh chị em)", type: "Danh từ" },
  { kanji: "手袋", kana: "てぶくろ", meaning: "găng tay", type: "Danh từ" },
  { kanji: "おもちゃ", kana: "おもちゃ", meaning: "đồ chơi", type: "Danh từ" },
  { kanji: "ぬいぐるみ", kana: "ぬいぐるみ", meaning: "thú nhồi bông", type: "Danh từ" },
  { kanji: "みかん", kana: "みかん", meaning: "quả quýt", type: "Danh từ" },
  { kanji: "方", kana: "かた", meaning: "ngài, vị", type: "Danh từ" },
  { kanji: "こちらの方", kana: "こちらのかた", meaning: "vị này", type: "Danh từ" },
  { kanji: "あの方", kana: "あのかた", meaning: "vị đó", type: "Danh từ" },
  { kanji: "近所", kana: "きんじょ", meaning: "lân cận, hàng xóm", type: "Danh từ" },
  { kanji: "作文", kana: "さくぶん", meaning: "bài văn", type: "Danh từ" },
  { kanji: "作業", kana: "さぎょう", meaning: "công việc", type: "Danh từ" },
  { kanji: "コーヒーカップ", kana: "コーヒーカップ", meaning: "cốc cà phê", type: "Danh từ" },
  { kanji: "シャーペン", kana: "シャーペン", meaning: "bút chì kim", type: "Danh từ" },
  { kanji: "セーター", kana: "セーター", meaning: "áo len", type: "Danh từ" },
  { kanji: "ティッシュ", kana: "ティッシュ", meaning: "khăn giấy", type: "Danh từ" },
  { kanji: "メロン", kana: "メロン", meaning: "quả dưa lưới", type: "Danh từ" },
  { kanji: "配る", kana: "くばる", meaning: "phân phát, phân phối", type: "Động từ" },
  { kanji: "直す", kana: "なおす", meaning: "sửa", type: "Động từ" },
  { kanji: "親切にする", kana: "しんせつにする", meaning: "đối xử tử tế (với ai)", type: "Động từ" },
  { kanji: "承知しました", kana: "しょうちしました", meaning: "Tôi hiểu rồi/ Tôi biết rồi ạ.", type: "Mẫu câu" },
  { kanji: "よろしく", kana: "よろしく(ね)", meaning: "Nhờ bạn nhé!", type: "Mẫu câu" },
  { kanji: "給料", kana: "きゅうりょう", meaning: "tiền lương", type: "Danh từ" },
  { kanji: "折り紙", kana: "おりがみ", meaning: "gấp giấy, origami", type: "Danh từ" },
  { kanji: "値段", kana: "ねだん", meaning: "giá tiền", type: "Danh từ" },
  { kanji: "締め切り", kana: "しめきり", meaning: "hạn chót, deadline", type: "Danh từ" },
  { kanji: "都合", kana: "つごう", meaning: "sự thuận tiện về hoàn cảnh", type: "Danh từ" },
  { kanji: "文句", kana: "もんく", meaning: "lời phàn nàn", type: "Danh từ" },
  { kanji: "保育園", kana: "ほいくえん", meaning: "nhà trẻ", type: "Danh từ" },
  { kanji: "アドバイス", kana: "アドバイス", meaning: "lời khuyên", type: "Danh từ" },
  { kanji: "スピーチ", kana: "スピーチ", meaning: "bài phát biểu", type: "Danh từ" },
  { kanji: "教わる", kana: "おそわる", meaning: "được dạy", type: "Động từ" },
  { kanji: "預かる", kana: "あずかる", meaning: "giữ, trông (giữ hộ người khác)", type: "Động từ" },
  { kanji: "太る", kana: "ふとる", meaning: "béo, mập", type: "Động từ" },
  { kanji: "痩せる", kana: "やせる", meaning: "gầy", type: "Động từ" },
  { kanji: "翻訳", kana: "ほんやく", meaning: "biên dịch", type: "Danh từ / Động từ" },
  { kanji: "交換", kana: "こうかん", meaning: "đổi, trao đổi", type: "Danh từ / Động từ" },
  { kanji: "長生き", kana: "ながいき", meaning: "sống thọ", type: "Danh từ / Động từ" },
  { kanji: "おわび", kana: "おわび", meaning: "lời xin lỗi", type: "Danh từ" },
  { kanji: "建築家", kana: "けんちくか", meaning: "kiến trúc sư", type: "Danh từ" },
  { kanji: "物語", kana: "ものがたり", meaning: "truyện cổ tích", type: "Danh từ" },
  { kanji: "チーム", kana: "チーム", meaning: "đội, team", type: "Danh từ" },
  { kanji: "はずかしい", kana: "はずかしい", meaning: "xấu hổ", type: "Tính từ đuôi い" },
  { kanji: "かむ", kana: "かむ", meaning: "cắn", type: "Động từ" },
  { kanji: "なぐる", kana: "なぐる", meaning: "đấm", type: "Động từ" },
  { kanji: "叱る", kana: "しかる", meaning: "mắng mỏ", type: "Động từ" },
  { kanji: "行う", kana: "おこなう", meaning: "tiến hành, tổ chức", type: "Động từ" },
  { kanji: "怒る", kana: "おこる", meaning: "nổi giận, tức giận", type: "Động từ" },
  { kanji: "踏む", kana: "ふむ", meaning: "giẫm", type: "Động từ" },
  { kanji: "ほえる", kana: "ほえる", meaning: "sủa", type: "Động từ" },
  { kanji: "いじめる", kana: "いじめる", meaning: "bắt nạt", type: "Động từ" },
  { kanji: "リサイクル", kana: "リサイクル", meaning: "tái chế", type: "Danh từ / Động từ" },
  { kanji: "発見", kana: "はっけん", meaning: "phát hiện", type: "Danh từ / Động từ" },
  { kanji: "発明", kana: "はつめい", meaning: "phát minh", type: "Danh từ / Động từ" },
  { kanji: "開催", kana: "かいさい", meaning: "tổ chức", type: "Danh từ / Động từ" },
  { kanji: "発売", kana: "はつばい", meaning: "mở bán", type: "Danh từ / Động từ" },
  { kanji: "勝手に", kana: "かってに", meaning: "tự ý, tự tiện (làm gì đó)", type: "Phó từ" },
  { kanji: "嘘", kana: "うそ", meaning: "lời nói dối", type: "Danh từ" },
  { kanji: "目玉焼き", kana: "めだまやき", meaning: "trứng ốp-la", type: "Danh từ" },
  { kanji: "咳", kana: "せき", meaning: "ho, cơn ho", type: "Danh từ" },
  { kanji: "戦争", kana: "せんそう", meaning: "chiến tranh", type: "Danh từ" },
  { kanji: "熱", kana: "ねつ", meaning: "cơn sốt", type: "Danh từ" },
  { kanji: "結果", kana: "けっか", meaning: "kết quả", type: "Danh từ" },
  { kanji: "階段", kana: "かいだん", meaning: "cầu thang", type: "Danh từ" },
  { kanji: "エスカレーター", kana: "エスカレーター", meaning: "cầu thang cuốn", type: "Danh từ" },
  { kanji: "ストレス", kana: "ストレス", meaning: "căng thẳng", type: "Danh từ" },
  { kanji: "真っ黒", kana: "まっくろ", meaning: "đen thui, đen sì", type: "Tính từ đuôi な" },
  { kanji: "ひどい", kana: "ひどい", meaning: "quá đáng, quá quắt", type: "Tính từ đuôi い" },
  { kanji: "偉い", kana: "えらい", meaning: "siêu, đỉnh, vĩ đại", type: "Tính từ đuôi い" },
  { kanji: "嘘をつく", kana: "うそをつく", meaning: "nói (dối)", type: "Động từ" },
  { kanji: "転ぶ", kana: "ころぶ", meaning: "ngã, lăn", type: "Động từ" },
  { kanji: "驚く", kana: "おどろく", meaning: "ngạc nhiên", type: "Động từ" },
  { kanji: "気になる", kana: "きになる", meaning: "để ý, bận tâm; thích", type: "Động từ" },
  { kanji: "焼ける", kana: "やける", meaning: "cháy", type: "Động từ" },
  { kanji: "鍵を掛ける", kana: "かぎをかける", meaning: "khoá (chìa khoá)", type: "Động từ" },
  { kanji: "ソースを掛ける", kana: "ソースをかける", meaning: "rưới (nước xốt)", type: "Động từ" },
  { kanji: "質問", kana: "しつもん", meaning: "hỏi, đặt câu hỏi", type: "Danh từ / Động từ" },
  { kanji: "入院", kana: "にゅういん", meaning: "nhập viện", type: "Danh từ / Động từ" },
  { kanji: "故障", kana: "こしょう", meaning: "bị hỏng", type: "Danh từ / Động từ" },
  { kanji: "貯金", kana: "ちょきん", meaning: "tiết kiệm tiền", type: "Danh từ / Động từ" },
  { kanji: "自分で", kana: "じぶんで", meaning: "tự mình", type: "Cụm từ" },
  { kanji: "おかげさまで", kana: "おかげさまで", meaning: "ơn trời, nhờ trời", type: "Mẫu câu" },
  { kanji: "ご心配をおかけする", kana: "ごしんぱいをおかけする", meaning: "khiến ai đó lo lắng", type: "Mẫu câu" },
  { kanji: "空気", kana: "くうき", meaning: "không khí", type: "Danh từ" },
  { kanji: "家賃", kana: "やちん", meaning: "tiền nhà", type: "Danh từ" },
  { kanji: "季節", kana: "きせつ", meaning: "mùa", type: "Danh từ" },
  { kanji: "画面", kana: "がめん", meaning: "màn hình", type: "Danh từ" },
  { kanji: "しわ", kana: "しわ", meaning: "nếp nhăn", type: "Danh từ" },
  { kanji: "疲れ", kana: "つかれ", meaning: "sự mệt mỏi", type: "Danh từ" },
  { kanji: "汗", kana: "あせ", meaning: "mồ hôi", type: "Danh từ" },
  { kanji: "骨", kana: "ほね", meaning: "xương", type: "Danh từ" },
  { kanji: "持ち運び", kana: "もちはこび", meaning: "mang theo", type: "Danh từ" },
  { kanji: "二日酔い", kana: "ふつかよい", meaning: "say nguội", type: "Danh từ" },
  { kanji: "ガラス", kana: "ガラス", meaning: "kính", type: "Danh từ" },
  { kanji: "ココナッツオイル", kana: "ココナッツオイル", meaning: "dầu dừa", type: "Danh từ" },
  { kanji: "コンクリート", kana: "コンクリート", meaning: "bê tông", type: "Danh từ" },
  { kanji: "ゴム", kana: "ゴム", meaning: "gôm, cao su", type: "Danh từ" },
  { kanji: "ハンバーガー", kana: "ハンバーガー", meaning: "bánh hamburger", type: "Danh từ" },
  { kanji: "ヒール", kana: "ヒール", meaning: "gót giày", type: "Danh từ" },
  { kanji: "プラスチック", kana: "プラスチック", meaning: "nhựa", type: "Danh từ" },
  { kanji: "最高", kana: "さいこう", meaning: "cao nhất; tuyệt vời", type: "Tính từ đuôi な / Danh từ" },
  { kanji: "やわらかい", kana: "やわらかい", meaning: "mềm", type: "Tính từ đuôi い" },
  { kanji: "酔う", kana: "よう", meaning: "say (tàu, xe...)", type: "Động từ" },
  { kanji: "燃える", kana: "もえる", meaning: "cháy được, bốc cháy", type: "Động từ" },
  { kanji: "滑る", kana: "すべる", meaning: "trơn trượt", type: "Động từ" },
  { kanji: "冷める", kana: "さめる", meaning: "nguội đi, lạnh đi", type: "Động từ" },
  { kanji: "何(を)やってるの", kana: "なに(を)やってるの", meaning: "(bạn) đang làm cái gì thế!", type: "Mẫu câu" },
  { kanji: "目が悪い", kana: "めがわるい", meaning: "mắt kém", type: "Cụm từ" },
  { kanji: "再来週", kana: "さらいしゅう", meaning: "tuần sau nữa", type: "Danh từ" },
  { kanji: "新年会", kana: "しんねんかい", meaning: "tiệc đầu năm", type: "Danh từ" },
  { kanji: "石けん", kana: "せっけん", meaning: "xà phòng, xà bông", type: "Danh từ" },
  { kanji: "不足", kana: "ふそく", meaning: "thiếu, không đủ", type: "Danh từ" },
  { kanji: "ネクタイ", kana: "ネクタイ", meaning: "cà-vạt", type: "Danh từ" },
  { kanji: "テーマ", kana: "テーマ", meaning: "chủ đề", type: "Danh từ" },
  { kanji: "スパゲッティ", kana: "スパゲッティ", meaning: "mỳ spaghetti", type: "Danh từ" },
  { kanji: "パスタ", kana: "パスタ", meaning: "mì pasta", type: "Danh từ" },
  { kanji: "ステーキ", kana: "ステーキ", meaning: "steak, bít-tết", type: "Danh từ" },
  { kanji: "サンドイッチ", kana: "サンドイッチ", meaning: "san-uých", type: "Danh từ" },
  { kanji: "冷たい", kana: "つめたい", meaning: "lạnh (cảm giác)", type: "Tính từ đuôi い" },
  { kanji: "急", kana: "きゅう", meaning: "đột ngột, đột nhiên", type: "Tính từ đuôi な" },
  { kanji: "大事", kana: "だいじ", meaning: "quan trọng", type: "Tính từ đuôi な" },
  { kanji: "決める", kana: "きめる", meaning: "quyết định", type: "Động từ" },
  { kanji: "禁煙", kana: "きんえん", meaning: "cấm hút thuốc", type: "Danh từ / Động từ" },
  { kanji: "早起き", kana: "はやおき", meaning: "dậy sớm", type: "Danh từ / Động từ" },
  { kanji: "賛成", kana: "さんせい", meaning: "tán thành", type: "Danh từ / Động từ" },
  { kanji: "離婚", kana: "りこん", meaning: "ly hôn", type: "Danh từ / Động từ" },
  { kanji: "以前から", kana: "いぜんから", meaning: "từ hồi trước", type: "Mẫu câu" },
  { kanji: "かな(あ)?", kana: "かな(あ)?", meaning: "có khi mình sẽ...", type: "Mẫu câu" },
  { kanji: "納豆", kana: "なっとう", meaning: "Natto, đậu tương lên men", type: "Danh từ" },
  { kanji: "暖房", kana: "だんぼう", meaning: "máy sưởi", type: "Danh từ" },
  { kanji: "水道", kana: "すいどう", meaning: "nước máy", type: "Danh từ" },
  { kanji: "睡眠", kana: "すいみん", meaning: "giấc ngủ", type: "Danh từ" },
  { kanji: "アイデア", kana: "アイデア", meaning: "ý tưởng", type: "Danh từ" },
  { kanji: "代", kana: "だい", meaning: "tiền (điện, nước...)", type: "Hậu tố" },
  { kanji: "無駄", kana: "むだ", meaning: "lãng phí", type: "Tính từ đuôi な" },
  { kanji: "踊る", kana: "おどる", meaning: "nhảy múa", type: "Động từ" },
  { kanji: "年を取る", kana: "としをとる", meaning: "già đi", type: "Động từ" },
  { kanji: "あいさつ", kana: "あいさつ", meaning: "chào hỏi", type: "Danh từ / Động từ" },
  { kanji: "チャレンジ", kana: "チャレンジ", meaning: "thử sức", type: "Danh từ / Động từ" },
  { kanji: "チェック", kana: "チェック", meaning: "kiểm tra; soát lại", type: "Danh từ / Động từ" },
  { kanji: "録音", kana: "ろくおん", meaning: "ghi âm", type: "Danh từ / Động từ" },
  { kanji: "予習", kana: "よしゅう", meaning: "soạn bài, chuẩn bị bài trước", type: "Danh từ / Động từ" },
  { kanji: "大体", kana: "だいたい", meaning: "đại khái", type: "Phó từ" },
  { kanji: "すっかり", kana: "すっかり", meaning: "hoàn toàn", type: "Phó từ" },
  { kanji: "できるだけ", kana: "できるだけ", meaning: "trong phạm vi có thể", type: "Phó từ" },
  { kanji: "なるべく", kana: "なるべく", meaning: "trong khả năng", type: "Phó từ" },
  { kanji: "最初は", kana: "さいしょは", meaning: "đầu tiên thì..., ban đầu thì...", type: "Mẫu câu" },
  { kanji: "大統領", kana: "だいとうりょう", meaning: "tổng thống", type: "Danh từ" },
  { kanji: "大学院", kana: "だいがくいん", meaning: "cao học", type: "Danh từ" },
  { kanji: "奨学金", kana: "しょうがくきん", meaning: "học bổng", type: "Danh từ" },
  { kanji: "郊外", kana: "こうがい", meaning: "ngoại thành, ngoại ô", type: "Danh từ" },
  { kanji: "連休", kana: "れんきゅう", meaning: "kỳ nghỉ, nghỉ liền nhiều ngày", type: "Danh từ" },
  { kanji: "山登り", kana: "やまのぼり", meaning: "sự leo núi", type: "Danh từ" },
  { kanji: "食べ放題", kana: "たべほうだい", meaning: "ăn thoải mái, ăn buffet", type: "Danh từ" },
  { kanji: "食材", kana: "しょくざい", meaning: "nguyên liệu nấu ăn", type: "Danh từ" },
  { kanji: "説明会", kana: "せつめいかい", meaning: "buổi giải thích", type: "Danh từ" },
  { kanji: "忘年会", kana: "ぼうねんかい", meaning: "tiệc tất niên", type: "Danh từ" },
  { kanji: "ピンク", kana: "ピンク", meaning: "màu hồng", type: "Danh từ" },
  { kanji: "思い出す", kana: "おもいだす", meaning: "nhớ ra", type: "Động từ" },
  { kanji: "渡す", kana: "わたす", meaning: "trao, đưa ~", type: "Động từ" },
  { kanji: "乗り換える", kana: "のりかえる", meaning: "đổi (tàu, chuyến xe ~)", type: "Động từ" },
  { kanji: "受ける", kana: "うける", meaning: "tham dự (kỳ thi)", type: "Động từ" },
  { kanji: "進学", kana: "しんがく", meaning: "học lên ~", type: "Danh từ / Động từ" },
  { kanji: "キャンセル", kana: "キャンセル", meaning: "huỷ bỏ", type: "Danh từ / Động từ" },
  { kanji: "就職する", kana: "しゅうしょくする", meaning: "bắt đầu công việc ở~", type: "Động từ" },
  { kanji: "ひさしぶりに", kana: "ひさしぶりに", meaning: "lâu lắm mới", type: "Mẫu câu" },
  { kanji: "よろしく", kana: "よろしく", meaning: "hãy ~ / nhớ (làm gì đó)", type: "Mẫu câu" },
  { kanji: "警察", kana: "けいさつ", meaning: "cảnh sát", type: "Danh từ" },
  { kanji: "論文", kana: "ろんぶん", meaning: "bài luận, luận văn", type: "Danh từ" },
  { kanji: "豚肉", kana: "ぶたにく", meaning: "thịt lợn", type: "Danh từ" },
  { kanji: "午前中", kana: "ごぜんちゅう", meaning: "trong buổi sáng", type: "Danh từ" },
  { kanji: "現金", kana: "げんきん", meaning: "tiền mặt", type: "Danh từ" },
  { kanji: "腰", kana: "こし", meaning: "eo lưng, hông", type: "Danh từ" },
  { kanji: "カーテン", kana: "カーテン", meaning: "rèm", type: "Danh từ" },
  { kanji: "目が覚める", kana: "めがさめる", meaning: "tỉnh dậy, thức dậy", type: "Động từ" },
  { kanji: "知らせる", kana: "しらせる", meaning: "cho biết, thông báo", type: "Động từ" },
  { kanji: "出発", kana: "しゅっぱつ", meaning: "xuất phát", type: "Danh từ / Động từ" },
  { kanji: "実験", kana: "じっけん", meaning: "thực nghiệm", type: "Danh từ / Động từ" },
  { kanji: "整理", kana: "せいり", meaning: "chỉnh lý, sắp xếp lại", type: "Danh từ / Động từ" },
  { kanji: "ジョギング", kana: "ジョギング", meaning: "chạy bộ", type: "Danh từ / Động từ" },
  { kanji: "しっかり", kana: "しっかり", meaning: "hẳn hoi, chắc chắn, kỹ càng", type: "Phó từ" },
  { kanji: "旅行会社", kana: "りょこうがいしゃ", meaning: "công ty du lịch", type: "Danh từ" },
  { kanji: "眠る", kana: "ねむる", meaning: "ngủ", type: "Động từ" },
  { kanji: "迎えに行く", kana: "むかえにいく", meaning: "đi đón", type: "Động từ" },
  { kanji: "選ぶ", kana: "えらぶ", meaning: "lựa chọn", type: "Động từ" },
  { kanji: "向かう", kana: "むかう", meaning: "hướng đến, đi đến ~", type: "Động từ" },
  { kanji: "戻る", kana: "もどる", meaning: "trở về, quay lại", type: "Động từ" },
  { kanji: "申し込む", kana: "もうしこむ", meaning: "đăng ký", type: "Động từ" },
  { kanji: "降りる", kana: "おりる", meaning: "xuống (tàu, xe...)", type: "Động từ" },
  { kanji: "修理", kana: "しゅうり", meaning: "sửa, chỉnh sửa", type: "Danh từ / Động từ" },
  { kanji: "支度", kana: "したく", meaning: "chuẩn bị", type: "Danh từ / Động từ" },
  { kanji: "ちょうど", kana: "ちょうど", meaning: "vừa đủ, vừa khéo", type: "Phó từ" },
  { kanji: "お気をつけて", kana: "おきをつけて", meaning: "xin hãy cẩn thận.", type: "Mẫu câu" },
  { kanji: "元の場所", kana: "もとのばしょ", meaning: "chỗ cũ", type: "Danh từ" },
  { kanji: "講義", kana: "こうぎ", meaning: "bài giảng", type: "Danh từ" },
  { kanji: "意見", kana: "いけん", meaning: "ý kiến", type: "Danh từ" },
  { kanji: "蓋", kana: "ふた", meaning: "nắp", type: "Danh từ" },
  { kanji: "缶", kana: "かん", meaning: "cái lon", type: "Danh từ" },
  { kanji: "悪口", kana: "わるぐち", meaning: "nói xấu", type: "Danh từ" },
  { kanji: "ルール", kana: "ルール", meaning: "quy tắc, quy định", type: "Danh từ" },
  { kanji: "ラベル", kana: "ラベル", meaning: "nhãn mác", type: "Danh từ" },
  { kanji: "ヘルメット", kana: "ヘルメット", meaning: "mũ bảo hiểm", type: "Danh từ" },
  { kanji: "ペットボトル", kana: "ペットボトル", meaning: "chai nhựa", type: "Danh từ" },
  { kanji: "サービス", kana: "サービス", meaning: "dịch vụ", type: "Danh từ" },
  { kanji: "以下", kana: "いか", meaning: "từ ~ trở xuống", type: "Hậu tố" },
  { kanji: "以上", kana: "いじょう", meaning: "từ ~ trở lên", type: "Hậu tố" },
  { kanji: "以内", kana: "いない", meaning: "trong vòng ~", type: "Hậu tố" },
  { kanji: "渡る", kana: "わたる", meaning: "đi qua, băng qua", type: "Động từ" },
  { kanji: "戻す", kana: "もどす", meaning: "để/ cất trở lại", type: "Động từ" },
  { kanji: "剥がす", kana: "はがす", meaning: "bóc", type: "Động từ" },
  { kanji: "はっきり", kana: "はっきり", meaning: "rõ ràng", type: "Phó từ" },
  { kanji: "もう", kana: "もう", meaning: "Thật là...", type: "Mẫu câu" },
  { kanji: "充電器", kana: "じゅうでんき", meaning: "củ sạc, ổ sạc", type: "Danh từ" },
  { kanji: "暗証番号", kana: "あんしょうばんごう", meaning: "mật khẩu", type: "Danh từ" },
  { kanji: "乗り場", kana: "のりば", meaning: "điểm bắt xe", type: "Danh từ" },
  { kanji: "シャンプー", kana: "シャンプー", meaning: "dầu gội", type: "Danh từ" },
  { kanji: "リンス", kana: "リンス", meaning: "dầu xả", type: "Danh từ" },
  { kanji: "ドイツ", kana: "ドイツ", meaning: "nước Đức", type: "Danh từ" },
  { kanji: "ペット", kana: "ペット", meaning: "thú nuôi", type: "Danh từ" },
  { kanji: "最悪", kana: "さいあく", meaning: "tồi tệ, tệ nhất", type: "Tính từ đuôi な" },
  { kanji: "迷う", kana: "まよう", meaning: "lạc (đường)", type: "Động từ" },
  { kanji: "残る", kana: "のこる", meaning: "còn lại, sót lại", type: "Động từ" },
  { kanji: "終わらせる", kana: "おわらせる", meaning: "kết thúc", type: "Động từ" },
  { kanji: "充電", kana: "じゅうでん", meaning: "sạc điện", type: "Danh từ / Động từ" },
  { kanji: "復習", kana: "ふくしゅう", meaning: "ôn tập", type: "Danh từ / Động từ" },
  { kanji: "そのままにする", kana: "そのままにする", meaning: "để nguyên như thế", type: "Cụm từ" },
  { kanji: "つい", kana: "つい", meaning: "lỡ, trót", type: "Phó từ" },
  { kanji: "疑問", kana: "ぎもん", meaning: "nghi vấn, câu hỏi", type: "Danh từ" },
  { kanji: "駐車場", kana: "ちゅうしゃじょう", meaning: "chỗ gửi xe", type: "Danh từ" },
  { kanji: "様子", kana: "ようす", meaning: "trạng thái", type: "Danh từ" },
  { kanji: "物価", kana: "ぶっか", meaning: "vật giá", type: "Danh từ" },
  { kanji: "数", kana: "かず", meaning: "con số", type: "Danh từ" },
  { kanji: "世界中", kana: "せかいじゅう", meaning: "trên toàn thế giới", type: "Danh từ" },
  { kanji: "留学生", kana: "りゅうがくせい", meaning: "lưu học sinh", type: "Danh từ" },
  { kanji: "健康", kana: "けんこう", meaning: "sức khoẻ", type: "Danh từ" },
  { kanji: "会場", kana: "かいじょう", meaning: "hội trường", type: "Danh từ" },
  { kanji: "和食", kana: "わしょく", meaning: "đồ ăn Nhật", type: "Danh từ" },
  { kanji: "筆箱", kana: "ふでばこ", meaning: "hộp bút", type: "Danh từ" },
  { kanji: "ストーブ", kana: "ストーブ", meaning: "lò sưởi", type: "Danh từ" },
  { kanji: "ガイドブック", kana: "ガイドブック", meaning: "sách hướng dẫn", type: "Danh từ" },
  { kanji: "インフルエンザ", kana: "インフルエンザ", meaning: "bệnh cúm", type: "Danh từ" },
  { kanji: "アラーム", kana: "アラーム", meaning: "báo thức", type: "Danh từ" },
  { kanji: "気がつく", kana: "きがつ", meaning: "để ý đến, nhận ra", type: "Động từ" },
  { kanji: "決まる", kana: "きまる", meaning: "được quyết định", type: "Động từ" },
  { kanji: "近づく", kana: "ちかづく", meaning: "lại gần, đến gần", type: "Động từ" },
  { kanji: "離れる", kana: "はなれる", meaning: "rời xa, cách xa", type: "Động từ" },
  { kanji: "用意", kana: "ようい", meaning: "chuẩn bị", type: "Danh từ / Động từ" },
  { kanji: "少しずつ", kana: "すこしずつ", meaning: "từng chút một", type: "Phó từ" },
  { kanji: "どんどん", kana: "どんどん", meaning: "nhanh chóng", type: "Phó từ" },
  { kanji: "だんだん", kana: "だんだん", meaning: "dần dần", type: "Phó từ" },
  { kanji: "課題", kana: "かだい", meaning: "bài tập; nhiệm vụ", type: "Danh từ" },
  { kanji: "生徒", kana: "せいと", meaning: "học sinh", type: "Danh từ" },
  { kanji: "教育", kana: "きょういく", meaning: "giáo dục", type: "Danh từ" },
  { kanji: "塾", kana: "じゅく", meaning: "trường luyện thi", type: "Danh từ" },
  { kanji: "技術", kana: "ぎじゅつ", meaning: "kỹ thuật", type: "Danh từ" },
  { kanji: "息子", kana: "むすこ", meaning: "con trai", type: "Danh từ" },
  { kanji: "娘", kana: "むすめ", meaning: "con gái", type: "Danh từ" },
  { kanji: "後輩", kana: "こうはい", meaning: "đàn em", type: "Danh từ" },
  { kanji: "会議室", kana: "かいぎしつ", meaning: "phòng họp", type: "Danh từ" },
  { kanji: "自由", kana: "じゆう", meaning: "tự do", type: "Tính từ đuôi な / Danh từ" },
  { kanji: "悲しむ", kana: "かなしむ", meaning: "đau buồn", type: "Động từ" },
  { kanji: "拾う", kana: "ひろう", meaning: "nhặt", type: "Động từ" },
  { kanji: "学ぶ", kana: "まなぶ", meaning: "học", type: "Động từ" },
  { kanji: "迎えに来る", kana: "むかえにくる", meaning: "đến đón ai đó", type: "Động từ" },
  { kanji: "経験", kana: "けいけん", meaning: "trải nghiệm", type: "Danh từ / Động từ" },
  { kanji: "部", kana: "ぶ", meaning: "bản, bộ", type: "Hậu tố" },
  { kanji: "上司", kana: "じょうし", meaning: "cấp trên", type: "Danh từ" },
  { kanji: "体育", kana: "たいいく", meaning: "thể dục", type: "Danh từ" },
  { kanji: "バイオリン", kana: "バイオリン", meaning: "đàn violin", type: "Danh từ" },
  { kanji: "バレエ", kana: "バレエ", meaning: "múa ba lê", type: "Danh từ" },
  { kanji: "高級", kana: "こうきゅう", meaning: "cao cấp", type: "Tính từ đuôi な" },
  { kanji: "頼む", kana: "たのむ", meaning: "nhờ ai đó làm gì", type: "Động từ" },
  { kanji: "写す", kana: "うつす", meaning: "sao chép, chép bài", type: "Động từ" },
  { kanji: "感動", kana: "かんどう", meaning: "cảm động", type: "Danh từ / Động từ" },
  { kanji: "まず", kana: "まず", meaning: "trước tiên, trước hết", type: "Phó từ" },
  { kanji: "他にも", kana: "ほかにも", meaning: "ngoài ra", type: "Mẫu câu" },
  { kanji: "発表会", kana: "はっぴょうかい", meaning: "buổi trình diễn", type: "Danh từ" },
  { kanji: "工場", kana: "こうじょう", meaning: "nhà máy, công xưởng", type: "Danh từ" },
  { kanji: "連絡先", kana: "れんらくさき", meaning: "địa chỉ liên lạc", type: "Danh từ" },
  { kanji: "ニックネーム", kana: "ニックネーム", meaning: "nickname, biệt danh", type: "Danh từ" },
  { kanji: "フロント", kana: "フロント", meaning: "quầy lễ tân", type: "Danh từ" },
  { kanji: "ポスター", kana: "ポスター", meaning: "poster, áp-phích", type: "Danh từ" },
  { kanji: "コート", kana: "コート", meaning: "áo khoác", type: "Danh từ" },
  { kanji: "名", kana: "めい", meaning: "~ người (đếm người)", type: "Hậu tố" },
  { kanji: "支払う", kana: "しはらう", meaning: "chi trả, thanh toán", type: "Động từ" },
  { kanji: "発表", kana: "はっぴょう", meaning: "phát biểu", type: "Danh từ / Động từ" },
  { kanji: "自慢する", kana: "じまんする", meaning: "tự mãn", type: "Động từ" },
  { kanji: "おつり", kana: "おつり", meaning: "tiền thừa", type: "Danh từ" },
  { kanji: "金額", kana: "きんがく", meaning: "khoản tiền, số tiền", type: "Danh từ" },
  { kanji: "お客様", kana: "おきゃくさま", meaning: "quý khách", type: "Danh từ" },
  { kanji: "保険証", kana: "ほけんしょう", meaning: "thẻ bảo hiểm", type: "Danh từ" },
  { kanji: "満席", kana: "まんせき", meaning: "kín chỗ, hết chỗ", type: "Danh từ" },
  { kanji: "丸", kana: "まる", meaning: "hình tròn, khoanh tròn", type: "Danh từ" },
  { kanji: "答え", kana: "こたえ", meaning: "câu trả lời", type: "Danh từ" },
  { kanji: "正しい", kana: "ただしい", meaning: "chính xác", type: "Tính từ đuôi い" },
  { kanji: "しまう", kana: "しまう", meaning: "cất đi", type: "Động từ" },
  { kanji: "泊まる", kana: "とまる", meaning: "trú lại, trọ lại", type: "Động từ" },
  { kanji: "過ごす", kana: "すごす", meaning: "trải qua", type: "Động từ" },
  { kanji: "確かめる", kana: "たしかめる", meaning: "xác nhận", type: "Động từ" },
  { kanji: "つける", kana: "つける", meaning: "khoanh (tròn)", type: "Động từ" },
  { kanji: "相談", kana: "そうだん", meaning: "bàn bạc", type: "Danh từ / Động từ" },
  { kanji: "見学", kana: "けんがく", meaning: "kiến tập", type: "Danh từ / Động từ" },
  { kanji: "契約", kana: "けいやく", meaning: "hợp đồng", type: "Danh từ / Động từ" },
  { kanji: "購入", kana: "こうにゅう", meaning: "mua", type: "Danh từ / Động từ" },
  { kanji: "少々", kana: "しょうしょう", meaning: "một chút", type: "Phó từ" },
  { kanji: "恐れ入ります", kana: "おそれいります", meaning: "Tôi xin cảm ơn ạ.", type: "Mẫu câu" },
  { kanji: "小学校", kana: "しょうがっこう", meaning: "trường tiểu học", type: "Danh từ" },
  { kanji: "小学生", kana: "しょうがくせい", meaning: "học sinh tiểu học", type: "Danh từ" },
  { kanji: "中学校", kana: "ちゅうがっこう", meaning: "trường THCS", type: "Danh từ" },
  { kanji: "中学生", kana: "ちゅうがくせい", meaning: "học sinh THCS", type: "Danh từ" },
  { kanji: "高校", kana: "こうこう", meaning: "trường THPT", type: "Danh từ" },
  { kanji: "高校生", kana: "こうこうせい", meaning: "học sinh THPT", type: "Danh từ" },
  { kanji: "耳", kana: "みみ", meaning: "tai", type: "Danh từ" },
  { kanji: "電卓", kana: "でんたく", meaning: "máy tính cầm tay", type: "Danh từ" },
  { kanji: "ゆかた", kana: "ゆかた", meaning: "Yukata", type: "Danh từ" },
  { kanji: "コピー機", kana: "コピーき", meaning: "máy phô-tô", type: "Danh từ" },
  { kanji: "エレベーター", kana: "エレベーター", meaning: "thang máy", type: "Danh từ" },
  { kanji: "汗をかく", kana: "あせをかく", meaning: "đổ/ toát mồ hôi", type: "Cụm từ" },
  { kanji: "隠れる", kana: "かくれる", meaning: "trốn", type: "Động từ" },
  { kanji: "入学", kana: "にゅうがく", meaning: "nhập học", type: "Danh từ / Động từ" },
  { kanji: "屋上", kana: "おくじょう", meaning: "sân thượng", type: "Danh từ" },
  { kanji: "筋トレ", kana: "きんトレ", meaning: "tập cơ bắp", type: "Danh từ" },
  { kanji: "電気屋", kana: "でんきや", meaning: "cửa hàng đồ điện", type: "Danh từ" },
  { kanji: "代金", kana: "だいきん", meaning: "tiền mua đồ", type: "Danh từ" },
  { kanji: "次", kana: "つぎ", meaning: "tiếp theo", type: "Danh từ" },
  { kanji: "ロシア", kana: "ロシア", meaning: "nước Nga", type: "Danh từ" },
  { kanji: "アフリカ", kana: "アフリカ", meaning: "châu Phi", type: "Danh từ" },
  { kanji: "前", kana: "まえ", meaning: "~ trước", type: "Hậu tố" },
  { kanji: "いつごろ", kana: "いつごろ", meaning: "khoảng khi nào?", type: "Phó từ" },
  { kanji: "生きる", kana: "いきる", meaning: "sống", type: "Động từ" },
  { kanji: "任せる", kana: "まかせる", meaning: "giao phó, bàn giao...", type: "Động từ" },
  { kanji: "ところで", kana: "ところで", meaning: "nhân tiện, à này", type: "Liên từ" },
  { kanji: "玄関", kana: "げんかん", meaning: "khu vực cửa ra vào", type: "Danh từ" },
  { kanji: "相撲", kana: "すもう", meaning: "môn đấu vật sumo", type: "Danh từ" },
  { kanji: "生け花", kana: "いけばな", meaning: "nghệ thuật cắm hoa", type: "Danh từ" },
  { kanji: "茶道", kana: "さどう", meaning: "trà đạo", type: "Danh từ" },
  { kanji: "宝くじ", kana: "たからくじ", meaning: "xổ số", type: "Danh từ" },
  { kanji: "不安", kana: "ふあん", meaning: "bất an, lo lắng", type: "Tính từ đuôi な" },
  { kanji: "直る", kana: "なおる", meaning: "được sửa", type: "Động từ" },
  { kanji: "話し合う", kana: "はなしあう", meaning: "nói chuyện với nhau", type: "Động từ" },
  { kanji: "要る", kana: "いる", meaning: "cần thiết", type: "Động từ" },
  { kanji: "当たる", kana: "あたる", meaning: "trúng (xổ số)", type: "Động từ" },
  { kanji: "絶対に", kana: "ぜったいに", meaning: "tuyệt đối", type: "Phó từ" },
  { kanji: "成績", kana: "せいせき", meaning: "thành tích", type: "Danh từ" },
  { kanji: "有休", kana: "ゆうきゅう", meaning: "nghỉ phép có lương", type: "Danh từ" },
  { kanji: "お見舞い", kana: "おみまい", meaning: "đi thăm", type: "Danh từ" },
  { kanji: "キャンプ", kana: "キャンプ", meaning: "cắm trại", type: "Danh từ" },
  { kanji: "ボタン", kana: "ボタン", meaning: "khuy áo, nút bấm", type: "Danh từ" },
  { kanji: "危険", kana: "きけん", meaning: "sự nguy hiểm", type: "Tính từ đuôi な" },
  { kanji: "押す", kana: "おす", meaning: "ấn; nhấn; bấm", type: "Động từ" },
  { kanji: "熱を出す", kana: "ねつをだす", meaning: "hạ sốt", type: "Cụm từ" },
  { kanji: "楽しみにする", kana: "たのしみにする", meaning: "mong chờ, mong đợi", type: "Cụm từ" },
  { kanji: "屋根", kana: "やね", meaning: "mái nhà", type: "Danh từ" },
  { kanji: "理由", kana: "りゆう", meaning: "nguyên nhân, lý do", type: "Danh từ" },
  { kanji: "キャンプ場", kana: "キャンプじょう", meaning: "nơi cắm trại", type: "Danh từ" },
  { kanji: "メーカー", kana: "メーカー", meaning: "nhà sản xuất", type: "Danh từ" },
  { kanji: "タイプ", kana: "タイプ", meaning: "kiểu, loại", type: "Danh từ" },
  { kanji: "点", kana: "てん", meaning: "điểm (số)", type: "Danh từ" },
  { kanji: "平気", kana: "へいき", meaning: "bình thản, bình tĩnh", type: "Tính từ đuôi な" },
  { kanji: "点を取る", kana: "てんをとる", meaning: "được ~ điểm", type: "Cụm từ" },
  { kanji: "許す", kana: "ゆるす", meaning: "tha thứ, cho phép", type: "Động từ" },
  { kanji: "謝る", kana: "あやまる", meaning: "xin lỗi", type: "Động từ" },
  { kanji: "帰国", kana: "きこく", meaning: "về nước", type: "Danh từ / Động từ" },
  { kanji: "どんなに", kana: "どんなに", meaning: "cho dù có... đến mức nào thì...", type: "Phó từ" },
  { kanji: "いくら", kana: "いくら", meaning: "dù có... bao nhiêu đi nữa thì vẫn...", type: "Phó từ" },
  { kanji: "もし", kana: "もし", meaning: "nếu, nếu như", type: "Phó từ" },
  { kanji: "つまみ", kana: "つまみ", meaning: "cái núm, nút điều khiển", type: "Danh từ" },
  { kanji: "不動産屋", kana: "ふどうさんや", meaning: "công ty/người làm bất động sản", type: "Danh từ" },
  { kanji: "春", kana: "はる", meaning: "mùa xuân", type: "Danh từ" },
  { kanji: "夏", kana: "なつ", meaning: "mùa hè", type: "Danh từ" },
  { kanji: "秋", kana: "あき", meaning: "mùa thu", type: "Danh từ" },
  { kanji: "冬", kana: "ふゆ", meaning: "mùa đông", type: "Danh từ" },
  { kanji: "紅葉", kana: "こうよう", meaning: "cây thích/ cây phong", type: "Danh từ" },
  { kanji: "機会", kana: "きかい", meaning: "cơ hội", type: "Danh từ" },
  { kanji: "角", kana: "かど", meaning: "góc", type: "Danh từ" },
  { kanji: "橋", kana: "はし", meaning: "cầu", type: "Danh từ" },
  { kanji: "踏み切り", kana: "ふみきり", meaning: "đoạn đường giao với đường sắt", type: "Danh từ" },
  { kanji: "忘れ物", kana: "わすれもの", meaning: "đồ bỏ quên", type: "Danh từ" },
  { kanji: "夕方", kana: "ゆうがた", meaning: "chiều tối", type: "Danh từ" },
  { kanji: "信号", kana: "しんごう", meaning: "tín hiệu đèn giao thông", type: "Danh từ" },
  { kanji: "葉", kana: "は", meaning: "lá", type: "Danh từ" },
  { kanji: "ぬるい", kana: "ぬるい", meaning: "âm ấm", type: "Tính từ đuôi い" },
  { kanji: "減らす", kana: "へらす", meaning: "giảm đi", type: "Động từ" },
  { kanji: "貯まる", kana: "たまる", meaning: "tích lại", type: "Động từ" },
  { kanji: "曲がる", kana: "まがる", meaning: "rẽ", type: "Động từ" },
  { kanji: "お茶をする", kana: "おちゃをする", meaning: "uống trà", type: "Cụm từ" },
  { kanji: "交渉", kana: "こうしょう", meaning: "đàm phán, thương lượng", type: "Danh từ / Động từ" },
  { kanji: "マッサージ", kana: "マッサージ", meaning: "mát xa", type: "Danh từ / Động từ" },
  { kanji: "まっすぐ", kana: "まっすぐ", meaning: "thẳng tắp", type: "Phó từ / Tính từ đuôi な" },
  { kanji: "億", kana: "おく", meaning: "~ trăm triệu", type: "Hậu tố" },
  { kanji: "側", kana: "がわ", meaning: "phía ~", type: "Hậu tố" },
  { kanji: "目", kana: "め", meaning: "thứ (tự) ~", type: "Hậu tố" },
  { kanji: "ほら", kana: "ほら", meaning: "Đấy! Kìa!", type: "Mẫu câu" },
  { kanji: "110番", kana: "ひゃくとおばん", meaning: "110 (cảnh sát)", type: "Danh từ" },
  { kanji: "119番", kana: "ひゃくじゅうきゅうばん", meaning: "119 (cứu hỏa)", type: "Danh từ" },
  { kanji: "たまねぎ", kana: "たまねぎ", meaning: "hành tây", type: "Danh từ" },
  { kanji: "乗り換え", kana: "のりかえ", meaning: "đổi (tàu/ xe)", type: "Danh từ" },
  { kanji: "数字", kana: "すうじ", meaning: "chữ số, con số", type: "Danh từ" },
  { kanji: "図", kana: "ず", meaning: "hình vẽ, biểu đồ", type: "Danh từ" },
  { kanji: "線", kana: "せん", meaning: "đường kẻ, đường thẳng", type: "Danh từ" },
  { kanji: "うまい", kana: "うまい", meaning: "ngon", type: "Tính từ đuôi い" },
  { kanji: "測る", kana: "はかる", meaning: "đo đạc (chiều dài...)", type: "Động từ" },
  { kanji: "起こす", kana: "おこす", meaning: "gây ra (tai nạn)", type: "Động từ" },
  { kanji: "進む", kana: "すすむ", meaning: "tiến lên", type: "Động từ" },
  { kanji: "混ぜる", kana: "まぜる", meaning: "trộn lẫn", type: "Động từ" },
  { kanji: "満足", kana: "まんぞく", meaning: "mãn nguyện", type: "Danh từ / Động từ" },
  { kanji: "計画", kana: "けいかく", meaning: "lên kế hoạch", type: "Danh từ / Động từ" },
  { kanji: "希望", kana: "きぼう", meaning: "mong muốn", type: "Danh từ / Động từ" },
  { kanji: "想像", kana: "そうぞう", meaning: "tưởng tượng", type: "Danh từ / Động từ" },
  { kanji: "予想", kana: "よそう", meaning: "dự đoán", type: "Danh từ / Động từ" },
  { kanji: "少なくとも", kana: "すくなくとも", meaning: "ít nhất thì", type: "Phó từ" },
  { kanji: "最低でも", kana: "さいていでも", meaning: "tối thiểu", type: "Phó từ" },
  { kanji: "お子さん", kana: "おこさん", meaning: "con (người khác)", type: "Danh từ" },
  { kanji: "先方", kana: "せんぽう", meaning: "đối tác", type: "Danh từ" },
  { kanji: "欠航", kana: "けっこう", meaning: "huỷ chuyến bay", type: "Danh từ" },
  { kanji: "国際", kana: "こくさい", meaning: "quốc tế", type: "Danh từ" },
  { kanji: "大雨", kana: "おおあめ", meaning: "cơn mưa to", type: "Danh từ" },
  { kanji: "発音", kana: "はつおん", meaning: "phát âm", type: "Danh từ" },
  { kanji: "やる", kana: "やる", meaning: "tưới (nước)", type: "Động từ" },
  { kanji: "祈る", kana: "いのる", meaning: "cầu nguyện", type: "Động từ" },
  { kanji: "貯める", kana: "ためる", meaning: "tiết kiệm", type: "Động từ" },
  { kanji: "わくわく", kana: "わくわく", meaning: "háo hức", type: "Danh từ / Động từ" },
  { kanji: "ご存知", kana: "ごぞんじ", meaning: "biết (kính ngữ của 知る)", type: "Danh từ" },
  { kanji: "寄る", kana: "よる", meaning: "ghé qua", type: "Động từ" },
  { kanji: "ご覧になる", kana: "ごらんになる", meaning: "nhìn (kính ngữ của 見る)", type: "Động từ" },
  { kanji: "召し上がる", kana: "めしあがる", meaning: "ăn, uống (kính ngữ)", type: "Động từ" },
  { kanji: "おっしゃる", kana: "おっしゃる", meaning: "nói (kính ngữ của 言う)", type: "Động từ" },
  { kanji: "なさる", kana: "なさる", meaning: "làm (kính ngữ của する)", type: "Động từ" },
  { kanji: "ちなみに", kana: "ちなみに", meaning: "nhân tiện", type: "Liên từ" },
  { kanji: "ようこそ", kana: "ようこそ", meaning: "Chào mừng", type: "Mẫu câu" },
  { kanji: "お越しくださいました", kana: "おこしくださいました", meaning: "Xin cảm ơn đã đến đây", type: "Mẫu câu" },
  { kanji: "全て", kana: "すべて", meaning: "toàn bộ", type: "Danh từ / Phó từ" },
  { kanji: "刺身定食", kana: "さしみていしょく", meaning: "suất cơm sashimi", type: "Danh từ" },
  { kanji: "刺身", kana: "さしみ", meaning: "sashimi", type: "Danh từ" },
  { kanji: "定食", kana: "ていしょく", meaning: "suất ăn", type: "Danh từ" },
  { kanji: "お手洗い", kana: "おてあらい", meaning: "nhà vệ sinh", type: "Danh từ" },
  { kanji: "お宅", kana: "おたく", meaning: "nhà (người bề trên)", type: "Danh từ" },
  { kanji: "さきほど", kana: "さきほど", meaning: "ban nãy, lúc nãy", type: "Phó từ" },
  { kanji: "契約書", kana: "けいやくしょ", meaning: "hợp đồng", type: "Danh từ" },
  { kanji: "先日", kana: "せんじつ", meaning: "hôm trước", type: "Danh từ" },
  { kanji: "部下", kana: "ぶか", meaning: "cấp dưới", type: "Danh từ" },
  { kanji: "のちほど", kana: "のちほど", meaning: "sau đó", type: "Phó từ" },
  { kanji: "お目にかかる", kana: "おめにかかる", meaning: "gặp mặt", type: "Động từ" },
  { kanji: "いただく", kana: "いただく", meaning: "ăn, uống, nhận", type: "Động từ" },
  { kanji: "伺う", kana: "うかがう", meaning: "hỏi, đến thăm", type: "Động từ" },
  { kanji: "おる", kana: "おる", meaning: "ở (khiêm nhường ngữ của いる)", type: "Động từ" },
  { kanji: "いたします", kana: "いたします", meaning: "làm (khiêm nhường ngữ của する)", type: "Động từ" },
  { kanji: "ございます", kana: "ございます", meaning: "có (khiêm nhường ngữ của あります)", type: "Động từ" },
  { kanji: "参ります", kana: "まいります", meaning: "đi, đến", type: "Động từ" },
  { kanji: "申します", kana: "もうします", meaning: "nói", type: "Động từ" },
  { kanji: "申し上げる", kana: "もうしあげる", meaning: "nói (ý kiến)", type: "Động từ" },
  { kanji: "存じます", kana: "ぞんじます", meaning: "biết, nghĩ", type: "Động từ" },
  { kanji: "存じ上げる", kana: "ぞんじあげる", meaning: "biết", type: "Động từ" },
  { kanji: "伝える", kana: "つたえる", meaning: "truyền đạt", type: "Động từ" },
  { kanji: "おかけください", kana: "おかけください", meaning: "xin mời ngồi", type: "Mẫu câu" },
  
  // --- BỔ SUNG TỪ VỰNG N5 (Mẫu đại diện) ---
  { kanji: "私", kana: "わたし", meaning: "tôi", type: "Đại từ" },
  { kanji: "あなた", kana: "あなた", meaning: "bạn", type: "Đại từ" },
  { kanji: "家族", kana: "かぞく", meaning: "gia đình", type: "Danh từ" },
  { kanji: "友達", kana: "ともだち", meaning: "bạn bè", type: "Danh từ" },
  { kanji: "学校", kana: "がっこう", meaning: "trường học", type: "Danh từ" },
  { kanji: "先生", kana: "せんせい", meaning: "giáo viên", type: "Danh từ" },
  { kanji: "学生", kana: "がくせい", meaning: "học sinh, sinh viên", type: "Danh từ" },
  { kanji: "行く", kana: "いく", meaning: "đi", type: "Động từ" },
  { kanji: "来る", kana: "くる", meaning: "đến", type: "Động từ" },
  { kanji: "帰る", kana: "かえる", meaning: "trở về", type: "Động từ" },
  { kanji: "食べる", kana: "たべる", meaning: "ăn", type: "Động từ" },
  { kanji: "飲む", kana: "のむ", meaning: "uống", type: "Động từ" },
  { kanji: "見る", kana: "みる", meaning: "nhìn, xem", type: "Động từ" },
  { kanji: "聞く", kana: "きく", meaning: "nghe, hỏi", type: "Động từ" },
  { kanji: "読む", kana: "よむ", meaning: "đọc", type: "Động từ" },
  { kanji: "書く", kana: "かく", meaning: "viết", type: "Động từ" },
  { kanji: "話す", kana: "はなす", meaning: "nói chuyện", type: "Động từ" },
  { kanji: "大きい", kana: "おおきい", meaning: "to, lớn", type: "Tính từ đuôi い" },
  { kanji: "小さい", kana: "ちいさい", meaning: "nhỏ, bé", type: "Tính từ đuôi い" },
  { kanji: "新しい", kana: "あたらしい", meaning: "mới", type: "Tính từ đuôi い" },
  { kanji: "古い", kana: "ふるい", meaning: "cũ", type: "Tính từ đuôi い" },
  { kanji: "良い", kana: "よい/いい", meaning: "tốt", type: "Tính từ đuôi い" },
  { kanji: "悪い", kana: "わるい", meaning: "xấu, tồi", type: "Tính từ đuôi い" },
  { kanji: "暑い", kana: "あつい", meaning: "nóng (thời tiết)", type: "Tính từ đuôi い" },
  { kanji: "寒い", kana: "さむい", meaning: "lạnh (thời tiết)", type: "Tính từ đuôi い" },
  { kanji: "今日", kana: "きょう", meaning: "hôm nay", type: "Danh từ thời gian" },
  { kanji: "明日", kana: "あした", meaning: "ngày mai", type: "Danh từ thời gian" },
  { kanji: "昨日", kana: "きのう", meaning: "hôm qua", type: "Danh từ thời gian" },
  { kanji: "今", kana: "いま", meaning: "bây giờ", type: "Danh từ thời gian" }
];

const kanjiData = [
  { kanji: "力", onyomi: "リョク, リキ", kunyomi: "ちから", meaning: "LỰC (Sức mạnh)", examples: "協力[きょうりょく] (Hợp tác)", mnemonic: "Hình ảnh cánh tay đang gồng lên khoe cơ bắp, thể hiện sức mạnh." },
  { kanji: "動", onyomi: "ドウ", kunyomi: "うご・く", meaning: "ĐỘNG (Cử động, chuyển động)", examples: "運動[うんどう] (Vận động), 動物[どうぶつ] (Động vật)", mnemonic: "Sức mạnh (力) dồn vào vật nặng (重) làm nó chuyển ĐỘNG." },
  { kanji: "働", onyomi: "ドウ", kunyomi: "はたら・く", meaning: "ĐỘNG (Làm việc)", examples: "働きます[はたらきます] (Làm việc)", mnemonic: "Người (亻) ĐỘNG (動) đậy chân tay liên tục tức là đang làm việc." },
  { kanji: "知", onyomi: "チ", kunyomi: "し・る", meaning: "TRI (Biết)", examples: "お知らせ[おしらせ] (Thông báo)", mnemonic: "Miệng (口) nói ra những điều nhanh như mũi tên (矢) bay, chứng tỏ là người có TRI thức." },
  { kanji: "短", onyomi: "タン", kunyomi: "みじか・い", meaning: "ĐOẢN (Ngắn)", examples: "短い[みじかい] (Ngắn), 短気[たんき] (Nóng nảy)", mnemonic: "Mũi tên (矢) bay cạnh hạt đậu (豆) tạo nên khoảng cách RẤT NGẮN." },
  { kanji: "医", onyomi: "イ", kunyomi: "-", meaning: "Y (Y học, bác sĩ)", examples: "医者[いしゃ] (Bác sĩ), 医学[いがく] (Y học)", mnemonic: "Khu vực che chắn để làm nghề Y." },
  { kanji: "皿", onyomi: "-", kunyomi: "さら", meaning: "MÃNH (Cái đĩa)", examples: "お皿[おさら] (Cái đĩa)", mnemonic: "Hình dáng chiếc đĩa đựng thức ăn." },
  { kanji: "血", onyomi: "ケツ", kunyomi: "ち", meaning: "HUYẾT (Máu)", examples: "血[ち] (Máu)", mnemonic: "Giọt máu (HUYẾT) rơi trên chiếc đĩa (皿)." },
  { kanji: "工", onyomi: "コウ, ク", kunyomi: "-", meaning: "CÔNG (Công trường)", examples: "工事[こうじ] (Thi công), 工場[こうじょう] (Nhà máy)", mnemonic: "Cây thước vuông dùng trong CÔNG trường." },
  { kanji: "空", onyomi: "クウ", kunyomi: "そら, から, あ・く", meaning: "KHÔNG (Bầu trời, trống không)", examples: "空[そら] (Bầu trời), 空港[くうこう] (Sân bay)", mnemonic: "Bầu trời (KHÔNG) rộng lớn phía trên hang động (穴) và công trường (工)." },
  { kanji: "試", onyomi: "シ", kunyomi: "こころ・みる, ため・す", meaning: "THÍ (Thử nghiệm, thi)", examples: "試験[しけん] (Kỳ thi), 試合[しあい] (Trận đấu)", mnemonic: "Dùng lời nói (言) để làm phép THÍ nghiệm." },
  { kanji: "計", onyomi: "ケイ", kunyomi: "はか・る", meaning: "KẾ (Kế hoạch, đo lường)", examples: "時計[とけい] (Đồng hồ), 計算[けいさん] (Tính toán)", mnemonic: "Nói (言) ra số đếm từ 1 đến 10 (十) là KẾ toán." },
  { kanji: "説", onyomi: "セツ, ゼイ", kunyomi: "と・く", meaning: "THUYẾT (Giải thích)", examples: "小説[しょうせつ] (Tiểu thuyết), 説明[せつめい] (Giải thích)", mnemonic: "Dùng lời nói (言) để THUYẾT minh, giải thích." },
  { kanji: "心", onyomi: "シン", kunyomi: "こころ", meaning: "TÂM (Trái tim)", examples: "安心[あんしん] (An tâm), 心配[しんぱい] (Lo lắng)", mnemonic: "Hình dáng của trái tim (TÂM)." },
  { kanji: "思", onyomi: "シ", kunyomi: "おも・う", meaning: "TƯ (Nghĩ)", examples: "思います[おもいます] (Nghĩ), 思い出します[おもいだします] (Nhớ ra)", mnemonic: "Ruộng (田) ở trên trái tim (心), trong lòng luôn TƯ lự nghĩ về ruộng đồng." },
  { kanji: "性", onyomi: "セイ, ショウ", kunyomi: "-", meaning: "TÍNH (Giới tính, tính cách)", examples: "女性[じょせい] (Nữ giới), 性格[せいかく] (Tính cách)", mnemonic: "Tâm (忄) sinh (生) ra đã có TÍNH cách riêng." },
  { kanji: "地", onyomi: "チ, ジ", kunyomi: "-", meaning: "ĐỊA (Đất)", examples: "地図[ちず] (Bản đồ), 地下鉄[ちかてつ] (Tàu điện ngầm)", mnemonic: "Vùng đất (土) có cả loài bò sát, là ĐỊA cầu." },
  { kanji: "池", onyomi: "チ", kunyomi: "いけ", meaning: "TRÌ (Cái ao)", examples: "池[いけ] (Ao), 電池[でんち] (Cục pin)", mnemonic: "Nước (氵) chảy vào chỗ đất trũng (也) tạo thành cái ao (TRÌ)." },
  { kanji: "公", onyomi: "コウ", kunyomi: "おおやけ", meaning: "CÔNG (Công cộng)", examples: "公園[こうえん] (Công viên), 主人公[しゅじんこう] (Nhân vật chính)", mnemonic: "Chia đều đồ vật tạo sự CÔNG bằng." },
  { kanji: "広", onyomi: "コウ", kunyomi: "ひろ・い", meaning: "QUẢNG (Rộng)", examples: "広い[ひろい] (Rộng), 広告[こうこく] (Quảng cáo)", mnemonic: "Căn nhà (广) rộng (QUẢNG) lớn." },
  { kanji: "去", onyomi: "キョ, コ", kunyomi: "さ・る", meaning: "KHỨ (Quá khứ, rời đi)", examples: "去年[きょねん] (Năm ngoái)", mnemonic: "Chôn giấu đất (土) xuống dưới, để những chuyện trong quá KHỨ rời đi." },
  { kanji: "転", onyomi: "テン", kunyomi: "ころ・ぶ", meaning: "CHUYỂN (Chuyển động, lăn)", examples: "転びます[ころびます] (Ngã), 運転[うんてん] (Lái xe)", mnemonic: "Chiếc xe (車) lăn bánh (CHUYỂN) vòng vòng." },
  { kanji: "遠", onyomi: "エン", kunyomi: "とお・い", meaning: "VIỄN (Xa)", examples: "遠い[とおい] (Xa)", mnemonic: "Mặc áo dài đi bộ (辶) quãng đường rất VIỄN (xa)." },
  { kanji: "園", onyomi: "エン", kunyomi: "-", meaning: "VIÊN (Vườn)", examples: "公園[こうえん] (Công viên), 動物園[どうぶつえん] (Sở thú)", mnemonic: "Khu vườn (VIÊN) rộng lớn có bao quanh (囗)." },
  { kanji: "台", onyomi: "タイ, ダイ", kunyomi: "-", meaning: "ĐÀI (Cái bục, đài)", examples: "台所[だいどころ] (Nhà bếp), 台風[たいふう] (Bão)", mnemonic: "Đứng trên bục (ĐÀI) để nói (口)." },
  { kanji: "始", onyomi: "シ", kunyomi: "はじ・める, はじ・まる", meaning: "THỦY (Bắt đầu)", examples: "始めます[はじめます] (Bắt đầu), 開始[かいし] (Khởi đầu)", mnemonic: "Người phụ nữ (女) THỦY chung bắt đầu (始) một mối quan hệ." },
  { kanji: "治", onyomi: "ジ, チ", kunyomi: "なお・す", meaning: "TRỊ (Chữa trị)", examples: "治します[なおします] (Chữa bệnh), 政治[せいじ] (Chính trị)", mnemonic: "Dùng nước (氵) để điều TRỊ vết thương bên cạnh cái đài (台)." },
  { kanji: "正", onyomi: "ショウ, セイ", kunyomi: "ただ・しい", meaning: "CHÍNH (Đúng, chính xác)", examples: "正しい[ただしい] (Đúng), お正月[おしょうがつ] (Tết)", mnemonic: "Một (一) bề tôi luôn CHÍNH trực." },
  { kanji: "政", onyomi: "セイ, ショウ", kunyomi: "まつりごと", meaning: "CHÍNH (Chính trị)", examples: "政治[せいじ] (Chính trị)", mnemonic: "Chính (正) quyền dùng vũ lực (攵) để cai trị (CHÍNH)." },
  { kanji: "王", onyomi: "オウ", kunyomi: "-", meaning: "VƯƠNG (Vua)", examples: "王様[おうさま] (Nhà vua)", mnemonic: "Người nối liền thiên-địa-nhân là VƯƠNG (Vua)." },
  { kanji: "玉", onyomi: "ギョク", kunyomi: "たま", meaning: "NGỌC (Viên ngọc, đồng xu)", examples: "お年玉[おとしだま] (Tiền lì xì), 目玉焼き[めだまやき] (Trứng ốp la)", mnemonic: "Chữ VƯƠNG (王) thêm dấu chấm thành viên NGỌC." },
  { kanji: "国", onyomi: "コク", kunyomi: "くに", meaning: "QUỐC (Đất nước)", examples: "国[くに] (Đất nước), 外国[がいこく] (Nước ngoài)", mnemonic: "Vua (王) cầm ngọc (玉) được bao quanh (囗) bảo vệ đất nước (QUỐC)." },
  { kanji: "主", onyomi: "シュ, ス", kunyomi: "おも, ぬし", meaning: "CHỦ (Ông chủ, chủ yếu)", examples: "ご主人[ごしゅじん] (Chồng), 飼い主[かいぬし] (Chủ nuôi)", mnemonic: "Chiếc đèn cầy rực sáng trong phòng của người CHỦ." },
  { kanji: "住", onyomi: "ジュウ", kunyomi: "す・む", meaning: "TRÚ (Sinh sống)", examples: "住みます[すみます] (Sống), 住所[じゅうしょ] (Địa chỉ)", mnemonic: "Người (亻) làm CHỦ (主) một nơi để cư TRÚ." },
  { kanji: "所", onyomi: "ショ", kunyomi: "ところ", meaning: "SỞ (Nơi chốn)", examples: "所[ところ] (Nơi, chỗ), 近所[きんじょ] (Hàng xóm)", mnemonic: "Chỗ chiếc rìu (斤) chặt cánh cửa (戸) là căn SỞ." },
  { kanji: "近", onyomi: "キン", kunyomi: "ちか・い", meaning: "CẬN (Gần)", examples: "近い[ちかい] (Gần), 最近[さいきん] (Gần đây)", mnemonic: "Mang rìu (斤) đi (辶) CẬN (gần) đến nơi." },
  { kanji: "辺", onyomi: "ヘン", kunyomi: "あたり, べ", meaning: "BIÊN (Vùng lân cận)", examples: "この辺[このへん] (Vùng này)", mnemonic: "Dùng đao (刀) vạch đường (辶) biên giới." },
  { kanji: "切", onyomi: "セツ, サイ", kunyomi: "き・る, き・れる", meaning: "THIẾT (Cắt)", examples: "切ります[きります] (Cắt), 切符[きっぷ] (Vé)", mnemonic: "Số bảy (七) bị đao (刀) cắt làm hai." },
  { kanji: "勉", onyomi: "ベン", kunyomi: "-", meaning: "MIỄN (Cố gắng, học)", examples: "勉強します[べんきょうします] (Học)", mnemonic: "Dùng sức lực (力) để MIỄN cưỡng học tập." },
  { kanji: "晩", onyomi: "バン", kunyomi: "-", meaning: "VÃN (Buổi tối)", examples: "今晩[こんばん] (Tối nay), 毎晩[まいばん] (Mỗi tối)", mnemonic: "Mặt trời (日) lặn là lúc VÃN (chiều tối)." },
  { kanji: "色", onyomi: "シキ, ショク", kunyomi: "いろ", meaning: "SẮC (Màu sắc)", examples: "色[いろ] (Màu sắc), 景色[けしき] (Phong cảnh)", mnemonic: "Màu SẮC (色) đa dạng." },
  { kanji: "発", onyomi: "ハツ, ホツ", kunyomi: "-", meaning: "PHÁT (Phát minh, xuất phát)", examples: "発明[はつめい] (Phát minh), 発見[はっけん] (Phát kiến)", mnemonic: "Bước chân (癶) đạp lên xuất PHÁT." },
  { kanji: "黄", onyomi: "オウ, コウ", kunyomi: "き", meaning: "HOÀNG (Màu vàng)", examples: "黄色[きいろ] (Màu vàng)", mnemonic: "Cánh đồng (田) chín HOÀNG (vàng)." },
  { kanji: "虫", onyomi: "チュウ", kunyomi: "むし", meaning: "TRÙNG (Côn trùng)", examples: "虫[むし] (Côn trùng)", mnemonic: "Con sâu, côn TRÙNG." },
  { kanji: "風", onyomi: "フウ, フ", kunyomi: "かぜ, かざ", meaning: "PHONG (Gió)", examples: "風[かぜ] (Gió), 台風[たいふう] (Bão)", mnemonic: "Côn trùng (虫) trú trong vỏ bọc để tránh PHONG (gió)." },
  { kanji: "強", onyomi: "キョウ, ゴウ", kunyomi: "つよ・い", meaning: "CƯỜNG (Khỏe, mạnh)", examples: "強い[つよい] (Mạnh), 勉強[べんきょう] (Học tập)", mnemonic: "Sức mạnh phi thường, CƯỜNG tráng." },
  { kanji: "油", onyomi: "ユ, ユウ", kunyomi: "あぶら", meaning: "DU (Dầu)", examples: "油[あぶら] (Dầu), 石油[せきゆ] (Dầu mỏ)", mnemonic: "Chất lỏng (氵) có nguồn gốc (由) là DU (dầu)." },
  { kanji: "決", onyomi: "ケツ", kunyomi: "き・める, き・まる", meaning: "QUYẾT (Quyết định)", examples: "決めます[きめます] (Quyết định)", mnemonic: "Nước (氵) chảy QUYẾT liệt." },
  { kanji: "漢", onyomi: "カン", kunyomi: "-", meaning: "HÁN (Chữ Hán, Trung Quốc)", examples: "漢字[かんじ] (Chữ Hán)", mnemonic: "Nước (氵) sông ở vùng đất HÁN." },
  { kanji: "止", onyomi: "シ", kunyomi: "と・める, と・まる, や・む", meaning: "CHỈ (Dừng lại)", examples: "止まります[とまります] (Dừng), 中止[ちゅうし] (Hủy bỏ)", mnemonic: "Bước chân CHỈ (dừng lại) không đi nữa." },
  { kanji: "歩", onyomi: "ホ, ブ, フ", kunyomi: "あゆ・む, ある・く", meaning: "BỘ (Đi bộ)", examples: "歩きます[あるきます] (Đi bộ), 散歩[さんぽ] (Đi dạo)", mnemonic: "Dừng (止) bước chân (少) để đi BỘ." },
  { kanji: "歴", onyomi: "レキ", kunyomi: "-", meaning: "LỊCH (Lịch sử)", examples: "歴史[れきし] (Lịch sử)", mnemonic: "Bước đi qua từng chặng đường tạo nên LỊCH sử." },
  { kanji: "史", onyomi: "シ", kunyomi: "-", meaning: "SỬ (Lịch sử)", examples: "歴史[れきし] (Lịch sử)", mnemonic: "Viết lại lời nói (口) thành SỬ sách." },
  { kanji: "使", onyomi: "シ", kunyomi: "つか・う", meaning: "SỬ (Sử dụng)", examples: "使います[つかいます] (Sử dụng), 大使館[たいしかん] (Đại sứ quán)", mnemonic: "Người (亻) được SỬ dụng để làm việc." },
  { kanji: "品", onyomi: "ヒン", kunyomi: "しな", meaning: "PHẨM (Sản phẩm)", examples: "商品[しょうひん] (Sản phẩm), 化粧品[けしょうひん] (Mỹ phẩm)", mnemonic: "Nhiều chiếc hộp (口) xếp chồng lên nhau thành hàng hóa (PHẨM)." },
  { kanji: "号", onyomi: "ゴウ, コウ", kunyomi: "-", meaning: "HIỆU (Số hiệu, ký hiệu)", examples: "信号[しんごう] (Tín hiệu), 電話番号[でんわばんごう] (Số điện thoại)", mnemonic: "Số (口) HIỆU để phân biệt." },
  { kanji: "味", onyomi: "ミ", kunyomi: "あじ, あじ・わう", meaning: "VỊ (Mùi vị)", examples: "味[あじ] (Mùi vị), 意味[いみ] (Ý nghĩa)", mnemonic: "Miệng (口) nếm xem (未) VỊ thế nào." },
  { kanji: "研", onyomi: "ケン", kunyomi: "と・ぐ", meaning: "NGHIÊN (Nghiên cứu)", examples: "研究[けんきゅう] (Nghiên cứu)", mnemonic: "Dùng đá (石) để NGHIÊN cứu." },
  { kanji: "丸", onyomi: "ガン", kunyomi: "まる, まる・い", meaning: "HOÀN (Tròn)", examples: "丸[まる] (Hình tròn)", mnemonic: "Số chín (九) thêm một chấm (、) thành viên bi HOÀN (tròn)." },
  { kanji: "究", onyomi: "キュウ", kunyomi: "きわ・める", meaning: "CỨU (Nghiên cứu)", examples: "研究[けんきゅう] (Nghiên cứu)", mnemonic: "Trong hang (穴) tìm hiểu tận CỨU (cùng)." },
  { kanji: "谷", onyomi: "コク", kunyomi: "たに", meaning: "CỐC (Thung lũng)", examples: "谷[たに] (Thung lũng)", mnemonic: "Nước chảy từ trên núi xuống thung lũng (CỐC)." },
  { kanji: "船", onyomi: "セン", kunyomi: "ふね, ふな", meaning: "THUYỀN (Cái thuyền)", examples: "船[ふね] (Con thuyền, tàu)", mnemonic: "Tàu (舟) chở theo 8 (八) miệng (口) ăn là một con THUYỀN." },
  { kanji: "里", onyomi: "リ", kunyomi: "さと", meaning: "LÍ (Làng quê, dặm)", examples: "里芋[さといも] (Khoai sọ)", mnemonic: "Ruộng (田) và đất (土) làm nên LÍ (làng quê)." },
  { kanji: "理", onyomi: "リ", kunyomi: "-", meaning: "LÍ (Lý do, nấu ăn)", examples: "料理[りょうり] (Món ăn), 修理[しゅうり] (Sửa chữa)", mnemonic: "Vua (王) cai quản làng quê (里) có LÍ lẽ." },
  { kanji: "野", onyomi: "ヤ", kunyomi: "の", meaning: "DÃ (Cánh đồng, hoang dã)", examples: "野菜[やさい] (Rau), 野球[やきゅう] (Bóng chày)", mnemonic: "Ngôi làng (里) mở rộng (予) ra thành cánh đồng (DÃ)." },
  { kanji: "若", onyomi: "ジャク, ニャク", kunyomi: "わか・い", meaning: "NHƯỢC (Trẻ)", examples: "若い[わかい] (Trẻ trung)", mnemonic: "Người vươn lên nụ cười (口) dưới cỏ cây (艹) là người rất trẻ (NHƯỢC)." },
  { kanji: "菜", onyomi: "サイ", kunyomi: "な", meaning: "THÁI (Rau)", examples: "野菜[やさい] (Rau)", mnemonic: "Cây cỏ (艹) hái (采) về làm THÁI (rau)." },
  { kanji: "番", onyomi: "バン", kunyomi: "-", meaning: "PHIÊN (Lượt, số)", examples: "一番[いちばん] (Số 1), 交番[こうばん] (Đồn cảnh sát)", mnemonic: "Đánh số (PHIÊN) từng mảnh ruộng (田)." },
  { kanji: "料", onyomi: "リョウ", kunyomi: "-", meaning: "LIỆU (Nguyên liệu, phí)", examples: "無料[むりょう] (Miễn phí), 料理[りょうり] (Nấu ăn)", mnemonic: "Dùng gạo (米) làm LIỆU đo lường (斗)." },
  { kanji: "奥", onyomi: "オウ, イク", kunyomi: "おく", meaning: "ÁO (Bên trong, vợ)", examples: "奥さん[おくさん] (Vợ người khác)", mnemonic: "Người đi vào bên trong (ÁO) góc khuất." },
  { kanji: "鳥", onyomi: "チョウ", kunyomi: "とり", meaning: "ĐIỂU (Con chim)", examples: "鳥[とり] (Con chim)", mnemonic: "Hình ảnh chú chim (ĐIỂU)." },
  { kanji: "鳴", onyomi: "メイ", kunyomi: "な・く, な・る", meaning: "MINH (Kêu, hót)", examples: "鳴ります[なります] (Reo), 鳴きます[なきます] (Hót)", mnemonic: "Miệng (口) chim (鳥) hót ríu rít (MINH)." },
  { kanji: "島", onyomi: "トウ", kunyomi: "しま", meaning: "ĐẢO (Hòn đảo)", examples: "島[しま] (Hòn đảo)", mnemonic: "Đỉnh núi (山) có chim (鳥) đậu gọi là ĐẢO." },
  { kanji: "化", onyomi: "カ, ケ", kunyomi: "ば・ける", meaning: "HÓA (Biến hóa)", examples: "文化[ぶんか] (Văn hóa), 化粧[けしょう] (Trang điểm)", mnemonic: "Người (亻) biến HÓA (七)." },
  { kanji: "便", onyomi: "ビン, ベン", kunyomi: "たよ・り", meaning: "TIỆN (Tiện lợi)", examples: "不便[ふべん] (Bất tiện), 便利[べんり] (Tiện lợi)", mnemonic: "Người (亻) có sự TIỆN lợi (更)." },
  { kanji: "係", onyomi: "ケイ", kunyomi: "かかり, かかる", meaning: "HỆ (Quan hệ, người phụ trách)", examples: "係の人[かかりのひと] (Người phụ trách)", mnemonic: "Người (亻) kết nối bằng sợi dây (系) là có HỆ lụy/quan hệ." },
  { kanji: "宿", onyomi: "シュク", kunyomi: "やど", meaning: "TÚC (Nơi trọ, bài tập)", examples: "宿題[しゅくだい] (Bài tập về nhà)", mnemonic: "Dưới mái nhà (宀) có hàng trăm (百) người cùng tá TÚC." },
  { kanji: "私", onyomi: "シ", kunyomi: "わたし, わたくし", meaning: "TƯ (Tôi, cá nhân)", examples: "私[わたし] (Tôi)", mnemonic: "Cá nhân (TƯ - ム) cầm cây lúa (禾)." },
  { kanji: "利", onyomi: "リ", kunyomi: "き・く", meaning: "LỢI (Tiện lợi, lợi ích)", examples: "便利[べんり] (Tiện lợi), 利用[りよう] (Sử dụng)", mnemonic: "Dùng dao (刂) gặt lúa (禾) sẽ đem lại LỢI ích." },
  { kanji: "科", onyomi: "カ", kunyomi: "-", meaning: "KHOA (Khoa học, môn học)", examples: "科学[かがく] (Khoa học), 教科書[きょうかしょ] (SGK)", mnemonic: "Đo lường (斗) lúa (禾) một cách KHOA học." },
  { kanji: "顔", onyomi: "ガン", kunyomi: "かお", meaning: "NHAN (Khuôn mặt)", examples: "顔[かお] (Gương mặt)", mnemonic: "Khuôn mặt (NHAN)." },
  { kanji: "題", onyomi: "ダイ", kunyomi: "-", meaning: "ĐỀ (Đề tài, vấn đề)", examples: "問題[もんだい] (Vấn đề), 宿題[しゅくだい] (Bài tập)", mnemonic: "Dùng trang giấy (頁) để viết ĐỀ bài (是)." },
  { kanji: "速", onyomi: "ソク", kunyomi: "はや・い", meaning: "TỐC (Nhanh)", examples: "速い[はやい] (Nhanh)", mnemonic: "Chạy (辶) đi buộc đồ (束) thật TỐC (nhanh)." },
  { kanji: "通", onyomi: "ツウ, ツ", kunyomi: "かよ・う, とお・る", meaning: "THÔNG (Đi lại, thông qua)", examples: "通います[かよいます] (Đi lại), 交通[こうつう] (Giao thông)", mnemonic: "Đi (辶) qua lối THÔNG trên đường." },
  { kanji: "週", onyomi: "シュウ", kunyomi: "-", meaning: "CHU (Tuần)", examples: "先週[せんしゅう] (Tuần trước), 今週[こんしゅう] (Tuần này)", mnemonic: "Chu kỳ (周) quay vòng đều đặn gọi là CHU (tuần)." },
  { kanji: "夫", onyomi: "フ, フウ", kunyomi: "おっと", meaning: "PHU (Chồng)", examples: "大丈夫[だいじょうぶ] (Không sao), 夫[おっと] (Chồng)", mnemonic: "Người đàn ông lớn (大) trụ cột gia đình (PHU)." },
  { kanji: "鉄", onyomi: "テツ", kunyomi: "-", meaning: "THIẾT (Sắt, thép)", examples: "地下鉄[ちかてつ] (Tàu điện ngầm)", mnemonic: "Mất đi (失) vàng (金) thì chỉ còn THIẾT (sắt)." },
  { kanji: "妹", onyomi: "マイ", kunyomi: "いもうと", meaning: "MUỘI (Em gái)", examples: "妹[いもうと] (Em gái)", mnemonic: "Người con gái (女) nhỏ bé chưa trưởng thành (未) là MUỘI (em gái)." },
  { kanji: "姉", onyomi: "シ", kunyomi: "あね", meaning: "TỈ (Chị gái)", examples: "姉[あね] (Chị gái), 姉妹[しまい] (Chị em gái)", mnemonic: "Người phụ nữ (女) đi chợ (市) là TỈ (chị gái)." },
  { kanji: "妻", onyomi: "サイ", kunyomi: "つま", meaning: "THÊ (Vợ)", examples: "妻[つま] (Vợ mình)", mnemonic: "Phụ nữ (女) dùng chổi quét nhà là THÊ (vợ)." },
  { kanji: "天", onyomi: "テン", kunyomi: "あめ, あま", meaning: "THIÊN (Trời)", examples: "天気[てんき] (Thời tiết)", mnemonic: "Kẻ vĩ đại (大) đội trời (一) là THIÊN." },
  { kanji: "送", onyomi: "ソウ", kunyomi: "おく・る", meaning: "TỔNG (Gửi, tiễn)", examples: "送ります[おくります] (Gửi)", mnemonic: "Dùng đường bộ (辶) để TỔNG tiễn." },
  { kanji: "弟", onyomi: "テイ, ダイ", kunyomi: "おとうと", meaning: "ĐỆ (Em trai)", examples: "弟[おとうと] (Em trai), 兄弟[きょうだい] (Anh em)", mnemonic: "Em trai (ĐỆ)." },
  
  // --- BỔ SUNG KANJI N5 (Mẫu đại diện) ---
  { kanji: "一", onyomi: "イチ, イツ", kunyomi: "ひと・つ", meaning: "NHẤT (Một)", examples: "一つ[ひとつ] (1 cái), 一月[いちがつ] (Tháng 1)", mnemonic: "Một gạch ngang là số 1." },
  { kanji: "二", onyomi: "ニ", kunyomi: "ふた・つ", meaning: "NHỊ (Hai)", examples: "二つ[ふたつ] (2 cái), 二月[にがつ] (Tháng 2)", mnemonic: "Hai gạch ngang là số 2." },
  { kanji: "三", onyomi: "サン", kunyomi: "みっ・つ", meaning: "TAM (Ba)", examples: "三つ[みっつ] (3 cái), 三月[さんがつ] (Tháng 3)", mnemonic: "Ba gạch ngang là số 3." },
  { kanji: "四", onyomi: "シ", kunyomi: "よっ・つ, よん", meaning: "TỨ (Bốn)", examples: "四つ[よっつ] (4 cái), 四月[しがつ] (Tháng 4)", mnemonic: "Hình vuông có 4 góc." },
  { kanji: "五", onyomi: "ゴ", kunyomi: "いつ・つ", meaning: "NGŨ (Năm)", examples: "五つ[いつつ] (5 cái), 五月[ごがつ] (Tháng 5)", mnemonic: "Số 5 viết theo chữ Hán." },
  { kanji: "六", onyomi: "ロク", kunyomi: "むっ・つ", meaning: "LỤC (Sáu)", examples: "六つ[むっつ] (6 cái), 六月[ろくがつ] (Tháng 6)", mnemonic: "Con người dang 2 tay 2 chân cộng thêm đầu và thân là 6 bộ phận." },
  { kanji: "七", onyomi: "シチ", kunyomi: "なな・つ", meaning: "THẤT (Bảy)", examples: "七つ[ななつ] (7 cái), 七月[しちがつ] (Tháng 7)", mnemonic: "Giống chữ T bị lộn ngược." },
  { kanji: "八", onyomi: "ハチ", kunyomi: "やっ・つ", meaning: "BÁT (Tám)", examples: "八つ[やっつ] (8 cái), 八月[はちがつ] (Tháng 8)", mnemonic: "Hai nét phẩy chia ra 2 bên." },
  { kanji: "九", onyomi: "キュウ, ク", kunyomi: "ここの・つ", meaning: "CỬU (Chín)", examples: "九つ[ここのつ] (9 cái), 九月[くがつ] (Tháng 9)", mnemonic: "Giống người đang chống đẩy." },
  { kanji: "十", onyomi: "ジュウ", kunyomi: "とお", meaning: "THẬP (Mười)", examples: "十[とお] (10 cái), 十月[じゅうがつ] (Tháng 10)", mnemonic: "Hình chữ thập (+)." },
  { kanji: "日", onyomi: "ニチ, ジツ", kunyomi: "ひ, か", meaning: "NHẬT (Mặt trời, ngày)", examples: "日曜日[にちようび] (Chủ nhật), 日本[にほん] (Nhật Bản)", mnemonic: "Hình tượng mặt trời hình chữ nhật." },
  { kanji: "月", onyomi: "ゲツ, ガツ", kunyomi: "つき", meaning: "NGUYỆT (Mặt trăng, tháng)", examples: "月曜日[げつようび] (Thứ 2), 一月[いちがつ] (Tháng 1)", mnemonic: "Hình tượng mặt trăng khuyết." },
  { kanji: "火", onyomi: "カ", kunyomi: "ひ", meaning: "HỎA (Lửa)", examples: "火曜日[かようび] (Thứ 3), 火山[かざん] (Núi lửa)", mnemonic: "Hình ảnh ngọn lửa đang cháy." },
  { kanji: "水", onyomi: "スイ", kunyomi: "みず", meaning: "THỦY (Nước)", examples: "水曜日[すいようび] (Thứ 4), 水[みず] (Nước)", mnemonic: "Dòng nước đang chảy." },
  { kanji: "木", onyomi: "モク, ボク", kunyomi: "き", meaning: "MỘC (Cây, gỗ)", examples: "木曜日[もくようび] (Thứ 5), 木[き] (Cây)", mnemonic: "Hình cái cây có cành và rễ." },
  { kanji: "金", onyomi: "キン, コン", kunyomi: "かね", meaning: "KIM (Vàng, tiền)", examples: "金曜日[きんようび] (Thứ 6), お金[おかね] (Tiền)", mnemonic: "Vàng được chôn giấu dưới đất (土)." },
  { kanji: "土", onyomi: "ド, ト", kunyomi: "つち", meaning: "THỔ (Đất)", examples: "土曜日[どようび] (Thứ 7), 土地[とち] (Đất đai)", mnemonic: "Mầm cây mọc lên từ mặt đất." },
  { kanji: "人", onyomi: "ジン, ニン", kunyomi: "ひと", meaning: "NHÂN (Người)", examples: "日本人[にほんじん] (Người Nhật), 人[ひと] (Người)", mnemonic: "Hình dáng người đang bước đi." }
];

const grammarData = [
  {
    structure: "Thể thường/ N/Aな + でしょう / だろう",
    meaning: "Chắc hẳn ~ / ~ phải không? (Phán đoán, xác nhận)",
    explanation: "Sử dụng khi đưa ra phán đoán, dự đoán và người nói tin rằng tỉ lệ xảy ra sự việc đó là khá cao. Hoặc dùng để xác nhận, kêu gọi sự đồng tình.",
    examples: [
      { jp: "明日は今日より気温が下がるでしょう。", vi: "Ngày mai chắc nhiệt độ sẽ giảm hơn hôm nay." },
      { jp: "たくさん勉強したから、きっと合格するだろうなあ。", vi: "Vì đã học nhiều nên chắc chắn sẽ thi đỗ thôi." }
    ]
  },
  {
    structure: "Thể thường + かもしれない",
    meaning: "Có lẽ ~ / Có khi không chừng",
    explanation: "Dùng để diễn tả phán đoán của người nói về một khả năng nào đó. Mức độ chắc chắn cao hay thấp đều dùng được.",
    examples: [
      { jp: "忙しいから、飲み会に行けないかもしれません。", vi: "Vì bận nên có lẽ tôi không thể đi nhậu được." },
      { jp: "もしかしたら、あの人はベトナム人かもしれませんね。", vi: "Không chừng người kia là người Việt Nam đấy." }
    ]
  },
  {
    structure: "Thể thường + みたいだ / ようだ",
    meaning: "Hình như ~ / Có vẻ ~",
    explanation: "Dùng để đưa ra phán đoán dựa trên điều bản thân nhìn thấy/nghe thấy. 'みたいだ' thường dùng trong văn nói, 'ようだ' trang trọng hơn.",
    examples: [
      { jp: "明日は台風みたいだね。", vi: "Ngày mai hình như có bão nhỉ." },
      { jp: "誰もいないようだ。", vi: "Có vẻ như không có ai ở đây cả." }
    ]
  },
  {
    structure: "Thể thường + はずだ",
    meaning: "Chắc chắn ~",
    explanation: "Dùng khi người nói đưa ra phán đoán khách quan dựa trên bối cảnh, hoặc tin tưởng chắc chắn dựa vào chứng cứ nào đó.",
    examples: [
      { jp: "田中さんは食堂にいるはずです。", vi: "Anh Tanaka chắc chắn đang ở nhà ăn." }
    ]
  },
  {
    structure: "Thể thường + らしい / そうだ",
    meaning: "Nghe nói là ~ / Thấy bảo là ~",
    explanation: "Truyền đạt lại thông tin nghe được từ người khác. 'そうだ' dùng khi thôngত্তি thông tin có nguồn gốc rõ ràng, độ chính xác cao. 'らしい' dùng với thông tin chung chung, tin đồn.",
    examples: [
      { jp: "あの店、おいしいらしいね。", vi: "Cửa hàng kia nghe nói ngon lắm đấy." },
      { jp: "田中さん、この前ハワイに行ったそうですよ。", vi: "Nghe nói anh Tanaka mới đi Hawaii đợt trước đấy." }
    ]
  },
  {
    structure: "Thể thường + し、〜し",
    meaning: "Vừa... vừa... / Vì... và vì...",
    explanation: "Dùng để liệt kê những đặc điểm cùng hướng (tích cực hoặc tiêu cực), hoặc đưa ra nhiều lý do cho một phán đoán.",
    examples: [
      { jp: "この小説は短いし、面白いし、おすすめですよ。", vi: "Cuốn tiểu thuyết này vừa ngắn, vừa thú vị, rất đáng đọc." }
    ]
  },
  {
    structure: "Thể thường + んです(か) / んですが",
    meaning: "Nhấn mạnh / Trình bày lý do / Mở lời",
    explanation: "Dùng để bộc bạch thông tin, giải thích lý do, đặt câu hỏi đào sâu vấn đề, hoặc mở lời trước khi nhờ vả, xin phép.",
    examples: [
      { jp: "昨日から、頭が痛いんです。", vi: "Từ hôm qua tôi đã bị đau đầu (giải thích lý do)." },
      { jp: "チケットが2枚あるんだけど、一緒に行かない？", vi: "Tớ có 2 vé xem ca nhạc, đi cùng tớ không? (mở lời)." }
    ]
  },
  {
    structure: "Vます(bỏ ます) / A(bỏ い/な) + そう",
    meaning: "Trông có vẻ ~ / Sắp ~",
    explanation: "Đưa ra phán đoán bằng thị giác về trạng thái, tính chất (Trông có vẻ ngon/bận). Hoặc diễn tả hành động sắp xảy ra (Sắp mưa/rơi).",
    examples: [
      { jp: "雨が降りそうですね。", vi: "Trời sắp mưa rồi nhỉ." },
      { jp: "このケーキは美味しそうですね。", vi: "Cái bánh này trông có vẻ ngon." }
    ]
  },
  {
    structure: "Aく / Nに / Aに + なる / する",
    meaning: "Trở nên ~ / Làm cho ~",
    explanation: "なる: Sự việc tự biến đổi một cách tự nhiên. する: Ai đó có chủ đích làm thay đổi sự việc.",
    examples: [
      { jp: "最近、マイさんはきれいになった。", vi: "Gần đây, Mai trở nên xinh đẹp hơn." },
      { jp: "部屋をきれいに掃除してください。", vi: "Hãy dọn dẹp căn phòng cho sạch sẽ." }
    ]
  },
  {
    structure: "Nが / を + Vてある",
    meaning: "Được V sẵn / Có trạng thái ~",
    explanation: "Diễn tả trạng thái kết quả của một hành động có chủ đích do ai đó đã làm sẵn (thường dùng tha động từ).",
    examples: [
      { jp: "壁にカレンダーが貼ってある。", vi: "Trên tường có dán sẵn tờ lịch." },
      { jp: "ホテルはもう予約してあります。", vi: "Tôi đã đặt sẵn khách sạn rồi." }
    ]
  },
  {
    structure: "Mệnh đề bổ nghĩa danh từ",
    meaning: "N mà ...",
    explanation: "Dùng Thể thông thường (V/A/N) đặt trước Danh từ để bổ sung ý nghĩa chi tiết cho Danh từ đó.",
    examples: [
      { jp: "私が昨日使っていた日本語の本です。", vi: "Đây là cuốn sách tiếng Nhật mà hôm qua tôi đã dùng." },
      { jp: "東京に行く用事があります。", vi: "Tôi có việc bận (mà phải) đi Tokyo." }
    ]
  },
  {
    structure: "Vる + のが + 得意 / 好き / 早い",
    meaning: "Làm V thì ~ (giỏi, thích, nhanh...)",
    explanation: "Dùng 'の' để danh từ hóa động từ, sau đó đưa ra đánh giá, nhận xét hoặc sở thích về hành động đó.",
    examples: [
      { jp: "Aさんは歌うのが得意です。", vi: "Anh A hát rất giỏi." },
      { jp: "私は料理をするのが苦手です。", vi: "Tôi rất kém khoản nấu ăn." }
    ]
  },
  {
    structure: "Vる / Vない + のを + 忘れる / やめる",
    meaning: "Quên / Dừng / Từ bỏ việc V",
    explanation: "Danh từ hóa hành động để làm tân ngữ cho các động từ như quên (忘れる), dừng lại (やめる), từ bỏ (あきらめる).",
    examples: [
      { jp: "家の鍵を閉めるのを忘れた。", vi: "Tôi quên mất việc khóa cửa nhà rồi." }
    ]
  },
  {
    structure: "Thể Mệnh lệnh (Vろ/Vえ) / Cấm đoán (Vるな)",
    meaning: "Hãy làm V / Không được làm V",
    explanation: "Dùng để ra lệnh hoặc cấm đoán gay gắt. Thường dùng trong tình huống khẩn cấp, biển báo, cổ vũ thể thao, hoặc nam giới thân thiết nói với nhau.",
    examples: [
      { jp: "危ない！走るな！", vi: "Nguy hiểm! Đừng chạy!" },
      { jp: "負けるなー！頑張れ！", vi: "Đừng thua nhé! Cố lên!" }
    ]
  },
  {
    structure: "〜と書いてある / 〜という意味です",
    meaning: "Được viết là ~ / Có nghĩa là ~",
    explanation: "Mẫu câu dùng để giải thích cách đọc, nội dung của biển báo, hoặc ý nghĩa của một từ vựng/câu nói.",
    examples: [
      { jp: "これは何と読むんですか。", vi: "Chữ này đọc là gì vậy?" },
      { jp: "「立入禁止」はここに入るなという意味です。", vi: "「立入禁止」 có nghĩa là cấm vào." }
    ]
  },
  {
    structure: "Vてもらう / Vていただく",
    meaning: "Được (ai đó) làm V cho",
    explanation: "Diễn tả sự biết ơn khi nhận được hành động giúp đỡ từ ai đó. いただく là cách nói khiêm nhường dùng với người bề trên.",
    examples: [
      { jp: "鈴木君に本を貸してもらった。", vi: "Tôi được cậu Suzuki cho mượn sách." },
      { jp: "先生に作文を見ていただきました。", vi: "Tôi đã được thầy giáo xem giúp bài tập làm văn." }
    ]
  },
  {
    structure: "Vてほしい / Vないでほしい",
    meaning: "Muốn (ai đó) làm V / không làm V",
    explanation: "Bày tỏ mong muốn, kỳ vọng của bản thân muốn người khác thực hiện hoặc không thực hiện một hành động nào đó.",
    examples: [
      { jp: "誰かに宿題を手伝ってほしい。", vi: "Tôi muốn ai đó giúp mình làm bài tập." },
      { jp: "早く秋になってほしいね。", vi: "Mong mùa thu đến thật nhanh nhỉ." }
    ]
  },
  {
    structure: "Thể bị động (受身形 - Vれる / Vられる)",
    meaning: "Bị / Được làm V",
    explanation: "Chủ ngữ là đối tượng tiếp nhận hành động (bị mắng, bị giẫm chân, được khen). Hoặc dùng cho sự vật (được tổ chức, được xây dựng).",
    examples: [
      { jp: "先生に褒められた。", vi: "Tôi được thầy giáo khen." },
      { jp: "2024年のオリンピックはフランスで開催されました。", vi: "Olympic năm 2024 đã được tổ chức ở Pháp." }
    ]
  },
  {
    structure: "Vます(bỏ ます) + ながら",
    meaning: "Vừa... vừa...",
    explanation: "Diễn tả 2 hành động diễn ra song song cùng lúc do một người thực hiện. Hành động ở vế sau là hành động chính.",
    examples: [
      { jp: "音楽を聞きながら自転車に乗るのは危ない。", vi: "Vừa nghe nhạc vừa lái xe đạp là rất nguy hiểm." }
    ]
  },
  {
    structure: "Vます(bỏ ます) + やすい / にくい",
    meaning: "Dễ V / Khó V",
    explanation: "Biểu thị một việc gì đó dễ hay khó thực hiện do tính chất của sự vật, hoặc một hiện tượng dễ/khó xảy ra.",
    examples: [
      { jp: "このペンは書きやすい。", vi: "Cây bút này rất dễ viết." },
      { jp: "冬は空気が乾いて火事が起きやすい。", vi: "Mùa đông không khí hanh khô nên dễ xảy ra hỏa hoạn." }
    ]
  },
  {
    structure: "Vます(bỏ ます) / A(bỏ い/な) + すぎる",
    meaning: "Quá... / Làm V quá nhiều",
    explanation: "Diễn tả mức độ của một trạng thái hoặc hành động vượt quá giới hạn bình thường (thường mang ý tiêu cực).",
    examples: [
      { jp: "食べすぎて、お腹が痛い。", vi: "Vì ăn quá nhiều nên bị đau bụng." },
      { jp: "この映画、面白すぎ。", vi: "Bộ phim này quá thú vị luôn." }
    ]
  },
  {
    structure: "Vる / Vない + ことにする / ことになる",
    meaning: "Quyết định V / Được quyết định V",
    explanation: "ことにする: Quyết định dựa trên ý chí cá nhân. ことになる: Quyết định của tập thể, tổ chức, hoặc do hoàn cảnh xui khiến.",
    examples: [
      { jp: "明日から甘いものを食べないことにする。", vi: "Tôi quyết định từ ngày mai sẽ không ăn đồ ngọt nữa." },
      { jp: "来週の土曜日、みんなで飲み会をすることになった。", vi: "Đã có quyết định là thứ 7 tuần sau mọi người sẽ đi nhậu." }
    ]
  },
  {
    structure: "Vる / Vない + ようにする / ようにしている",
    meaning: "Cố gắng làm / Không làm V",
    explanation: "Thể hiện sự nỗ lực tạo lập thói quen hoặc cố gắng thực hiện một hành động vì mục đích nào đó.",
    examples: [
      { jp: "できるだけ早く起きるようにする。", vi: "Tôi sẽ cố gắng dậy sớm hết mức có thể." }
    ]
  },
  {
    structure: "Vるようになる / Vなくなる",
    meaning: "Bắt đầu có thể V / Không còn V nữa",
    explanation: "Diễn tả sự thay đổi trạng thái từ không thể sang có thể (hoặc ngược lại), hoặc sự thay đổi một thói quen.",
    examples: [
      { jp: "自転車に乗れるようになった。", vi: "Tôi đã bắt đầu biết đi xe đạp." },
      { jp: "年を取って、早く歩けなくなった。", vi: "Có tuổi rồi nên không thể đi bộ nhanh được nữa." }
    ]
  },
  {
    structure: "Vた / Vない + ほうがいい",
    meaning: "Nên / Không nên V",
    explanation: "Đưa ra lời khuyên hoặc cảnh báo cho đối phương để tránh gặp rắc rối.",
    examples: [
      { jp: "一度病院に行ったほうがいいですよ。", vi: "Bạn nên đi bệnh viện khám một lần xem sao." }
    ]
  },
  {
    structure: "V1たり、V2たりする",
    meaning: "Lúc thì V1, lúc thì V2",
    explanation: "Liệt kê một vài hành động tiêu biểu trong số nhiều hành động khác mà không cần theo trình tự thời gian.",
    examples: [
      { jp: "海で泳いだり、買い物したりしました。", vi: "Tôi đã đi bơi ở biển, rồi đi mua sắm (và làm nhiều việc khác nữa)." }
    ]
  },
  {
    structure: "V1たら、V2た (Bất ngờ)",
    meaning: "Khi V1 thì (bất ngờ) V2 xảy ra/phát hiện ra",
    explanation: "Diễn tả việc chủ ngữ đang làm hành động V1 thì tình cờ phát hiện ra một sự vật/sự việc mới V2.",
    examples: [
      { jp: "道を歩いていたら、財布が落ちていた。", vi: "Đang đi bộ trên đường thì tôi thấy có cái ví rơi." }
    ]
  },
  {
    structure: "Vてしまう / Vちゃう / Vておく",
    meaning: "Lỡ, trót V (Tiếc nuối) / Làm V sẵn",
    explanation: "てしまう: Hoàn thành trọn vẹn hoặc lỡ làm gì để lại sự nuối tiếc. ておく: Chuẩn bị sẵn trước cho mục đích tương lai.",
    examples: [
      { jp: "財布を落としてしまったんです。", vi: "Tôi lỡ làm rơi ví mất rồi." },
      { jp: "友達が来る前に、部屋を掃除しておかなきゃ。", vi: "Trước khi bạn đến, tôi phải dọn dẹp sẵn căn phòng." }
    ]
  },
  {
    structure: "Thể sai khiến (使役形 - Vさせる)",
    meaning: "Bắt làm V / Cho phép làm V",
    explanation: "Dùng để biểu thị người trên bắt buộc hoặc cho phép người dưới làm một việc gì đó.",
    examples: [
      { jp: "親は子供に野菜を食べさせる。", vi: "Bố mẹ bắt con cái ăn rau." },
      { jp: "社長は私たちを1時間待たせた。", vi: "Giám đốc đã bắt chúng tôi đợi 1 tiếng đồng hồ." }
    ]
  },
  {
    structure: "Vさせられる (Bị động sai khiến)",
    meaning: "Bị bắt làm V",
    explanation: "Diễn tả việc bị người khác ép buộc làm điều mà bản thân không hề mong muốn.",
    examples: [
      { jp: "子供のころ、親によく苦手なものを食べさせられました。", vi: "Hồi nhỏ, tôi hay bị bố mẹ bắt ăn những món mình không thích." }
    ]
  },
  {
    structure: "Tôn kính ngữ (尊敬語)",
    meaning: "Kính ngữ dành cho người trên",
    explanation: "Nâng tầm hành động của người bề trên (Giám đốc, Khách hàng, Thầy cô). Dùng おVになる, Vられる, hoặc các động từ đặc biệt (いらっしゃる, めしあがる, おっしゃる, なさる).",
    examples: [
      { jp: "社長はもうお帰りになりました。", vi: "Giám đốc đã về rồi ạ." },
      { jp: "先生はこのドラマをご存知ですか。", vi: "Thầy có biết bộ phim này không ạ?" }
    ]
  },
  {
    structure: "Khiêm nhường ngữ (謙譲語)",
    meaning: "Khiêm nhường hành động của bản thân",
    explanation: "Hạ thấp hành động của bản thân hoặc người phe mình để tôn trọng người nghe. Dùng おVする, ごNする, hoặc các từ đặc biệt (おる, まいる, いただく, 申す, 伺う).",
    examples: [
      { jp: "お荷物は明日お届けします。", vi: "Hành lý thì ngày mai tôi sẽ gửi đến ạ." },
      { jp: "私は山田と申します。", vi: "Tôi tên là Yamada." }
    ]
  },
  {
    structure: "〜とき / 〜間に / 〜までに",
    meaning: "Khi / Trong lúc / Cho đến trước khi",
    explanation: "Các cấu trúc chỉ mốc thời gian. 間に: Trong khoảng thời gian đó có việc xen vào. までに: Hạn chót để hoàn thành.",
    examples: [
      { jp: "私が料理している間に、テーブルを片付けて。", vi: "Trong lúc mẹ nấu ăn, con hãy dọn bàn đi." },
      { jp: "明日の3時までに返事をください。", vi: "Hãy phản hồi cho tôi chậm nhất là trước 3 giờ ngày mai." }
    ]
  },
  {
    structure: "〜ので / 〜のに / 〜ても",
    meaning: "Vì / Mặc dù... vậy mà / Cho dù",
    explanation: "ので: Lý do khách quan lịch sự. のに: Nghịch lý, bất mãn. ても: Điều kiện nghịch (dù A thì B vẫn không đổi).",
    examples: [
      { jp: "安くても、このメーカーの商品は買いません！", vi: "Cho dù có rẻ tôi cũng không mua sản phẩm của hãng này đâu!" },
      { jp: "早く寝たのに眠いんだよ。", vi: "Dù đã ngủ sớm vậy mà vẫn buồn ngủ." }
    ]
  },
  {
    structure: "〜たら / 〜と / 〜ば",
    meaning: "Nếu / Hễ / Giả định",
    explanation: "たら: Điều kiện giả định rộng rãi nhất. と: Điều kiện tất yếu (máy móc, thói quen, chân lý). ば: Điều kiện cần.",
    examples: [
      { jp: "雨が降ったら、試合は中止します。", vi: "Nếu trời mưa thì trận đấu sẽ bị huỷ." },
      { jp: "この道をまっすぐ行くと、銀行があります。", vi: "Hễ đi thẳng đường này là sẽ thấy ngân hàng." }
    ]
  },
  {
    structure: "〜ために / 〜ように",
    meaning: "Để (Mục đích)",
    explanation: "ために: Mục đích rõ ràng, ý chí mạnh (cùng chủ ngữ). ように: Cầu mong đạt được trạng thái (thường đi với V khả năng/V vô ý chí, có thể khác chủ ngữ).",
    examples: [
      { jp: "旅行のためにお金を貯めています。", vi: "Tôi đang tiết kiệm tiền để đi du lịch." },
      { jp: "忘れないように、メモしておきます。", vi: "Tôi sẽ ghi chú lại để không bị quên." }
    ]
  }
];

const readingVocabDict = {
  "旅行": { kana: "りょこう", meaning: "Du lịch" },
  "台風": { kana: "たいふう", meaning: "Cơn bão" },
  "中止": { kana: "ちゅうし", meaning: "Hủy bỏ, đình chỉ" },
  "残念": { kana: "ざんねん", meaning: "Đáng tiếc" },
  "温泉": { kana: "おんせん", meaning: "Suối nước nóng" },
  "予定": { kana: "よてい", meaning: "Dự định" }
};


// --- CÁC COMPONENT CHÍNH ---

export default function App() {
  const [activeView, setActiveView] = useState({ tab: 'roadmap', slice: null, title: '' });
  const [isChatOpen, setIsChatOpen] = useState(false);
  const [aiPrompt, setAiPrompt] = useState('');

  // PROGRESS STATE
  const [progress, setProgress] = useState(() => {
    try {
      const saved = localStorage.getItem('n4_progress');
      const parsed = saved ? JSON.parse(saved) : {};
      return {
        roadmap: parsed.roadmap || {}, // old format fallback
        dailyTasks: parsed.dailyTasks || {},
        kanjiMastered: parsed.kanjiMastered || [],
        vocabMastered: parsed.vocabMastered || [],
        grammarMastered: parsed.grammarMastered || []
      };
    } catch (e) {
      return { roadmap: {}, dailyTasks: {}, kanjiMastered: [], vocabMastered: [], grammarMastered: [] };
    }
  });

  useEffect(() => {
    localStorage.setItem('n4_progress', JSON.stringify(progress));
  }, [progress]);

  const openChatWithPrompt = (text) => {
    setAiPrompt(text);
    setIsChatOpen(true);
  };

  const navItems = [
    { id: 'roadmap', icon: <Map size={20}/>, label: 'Lộ trình' },
    { id: 'vocab', icon: <BookOpen size={20}/>, label: 'Từ vựng' },
    { id: 'kanji', icon: <PenTool size={20}/>, label: 'Kanji' },
    { id: 'grammar', icon: <Type size={20}/>, label: 'Ngữ pháp' },
    { id: 'reading', icon: <AlignLeft size={20}/>, label: 'Đọc hiểu' },
  ];

  return (
    <div className="min-h-screen bg-slate-50 font-sans text-slate-800 flex flex-col md:flex-row">
      {/* Sidebar Navigation */}
      <aside className="w-full md:w-64 bg-white shadow-xl flex-shrink-0 z-10 md:min-h-screen sticky top-0 flex flex-col">
        <div className="p-6 text-center border-b">
          <h1 className="text-2xl font-bold text-red-500 flex items-center justify-center gap-2">
            <span className="bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center">N4</span>
            Mastery
          </h1>
          <p className="text-xs text-slate-500 mt-1">JLPT & NAT-Test Prep</p>
        </div>
        
        {/* Progress Widget */}
        <div className="p-5 border-b border-slate-100 bg-slate-50/50 hidden md:block">
          <div className="flex justify-between items-center mb-3">
            <span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Tiến độ tổng</span>
            <Trophy size={16} className="text-amber-500"/>
          </div>
          <div className="space-y-4">
            <div>
              <div className="flex justify-between text-xs mb-1.5">
                <span className="text-slate-600 font-medium">Kanji đã thuộc</span>
                <span className="font-bold text-emerald-600">{progress.kanjiMastered.length}/{kanjiData.length}</span>
              </div>
              <div className="w-full bg-slate-200 rounded-full h-2">
                <div className="bg-emerald-500 h-2 rounded-full transition-all duration-500" style={{width: `${(progress.kanjiMastered.length/kanjiData.length)*100}%`}}></div>
              </div>
            </div>
            <div>
              <div className="flex justify-between text-xs mb-1.5">
                <span className="text-slate-600 font-medium">Từ vựng đã thuộc</span>
                <span className="font-bold text-blue-600">{progress.vocabMastered?.length || 0}/{vocabData.length}</span>
              </div>
              <div className="w-full bg-slate-200 rounded-full h-2">
                <div className="bg-blue-500 h-2 rounded-full transition-all duration-500" style={{width: `${((progress.vocabMastered?.length || 0)/vocabData.length)*100}%`}}></div>
              </div>
            </div>
            <div>
              <div className="flex justify-between text-xs mb-1.5">
                <span className="text-slate-600 font-medium">Ngữ pháp đã học</span>
                <span className="font-bold text-purple-600">{progress.grammarMastered?.length || 0}/{grammarData.length}</span>
              </div>
              <div className="w-full bg-slate-200 rounded-full h-2">
                <div className="bg-purple-500 h-2 rounded-full transition-all duration-500" style={{width: `${((progress.grammarMastered?.length || 0)/grammarData.length)*100}%`}}></div>
              </div>
            </div>
          </div>
        </div>

        <nav className="p-4 flex md:flex-col gap-2 overflow-x-auto no-scrollbar flex-1">
          {navItems.map((item) => (
            <button
              key={item.id}
              onClick={() => setActiveView({ tab: item.id, slice: null, title: '' })}
              className={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium whitespace-nowrap md:whitespace-normal
                ${activeView.tab === item.id 
                  ? 'bg-red-50 text-red-600 shadow-sm' 
                  : 'hover:bg-slate-100 text-slate-600 hover:text-slate-900'}`}
            >
              {item.icon}
              {item.label}
            </button>
          ))}
        </nav>
      </aside>

      {/* Main Content Area */}
      <main className="flex-1 p-4 md:p-8 overflow-y-auto relative">
        <div className="max-w-5xl mx-auto pb-20">
          {activeView.tab === 'roadmap' && <RoadmapTab onNavigate={(tab, slice, title) => setActiveView({ tab, slice, title })} progress={progress} setProgress={setProgress} />}
          {activeView.tab === 'vocab' && <VocabTab progress={progress} setProgress={setProgress} slice={activeView.slice} customTitle={activeView.title} />}
          {activeView.tab === 'kanji' && <KanjiTab progress={progress} setProgress={setProgress} slice={activeView.slice} customTitle={activeView.title} />}
          {activeView.tab === 'grammar' && <GrammarTab progress={progress} setProgress={setProgress} openChatWithPrompt={openChatWithPrompt} slice={activeView.slice} customTitle={activeView.title} />}
          {activeView.tab === 'reading' && <ReadingTab openChatWithPrompt={openChatWithPrompt} customTitle={activeView.title} />}
        </div>

        {/* Nút Chat AI Floating */}
        <button
          onClick={() => setIsChatOpen(!isChatOpen)}
          className={`fixed bottom-6 right-6 p-4 text-white rounded-full shadow-lg hover:scale-110 transition-all z-50 flex items-center justify-center ${isChatOpen ? 'bg-slate-700 hover:bg-slate-800 shadow-slate-700/30' : 'bg-indigo-600 hover:bg-indigo-700 shadow-indigo-600/30'}`}
        >
          {isChatOpen ? <X size={28} /> : <MessageCircle size={28} />}
        </button>

        {/* Cửa sổ Chat AI */}
        {isChatOpen && (
          <GeminiChat 
            onClose={() => setIsChatOpen(false)} 
            initialPrompt={aiPrompt}
            clearInitialPrompt={() => setAiPrompt('')}
          />
        )}
      </main>
    </div>
  );
}

/* =========================================
   TAB: LỘ TRÌNH (ROADMAP)
   ========================================= */
function RoadmapTab({ onNavigate, progress, setProgress }) {
  const [duration, setDuration] = useState(3); // 1, 3, 6
  const [expandedPhase, setExpandedPhase] = useState(0);

  const plans = {
    1: [
      { 
        week: "Tuần 1", title: "Khởi động & Nền tảng (Chương 15-19)", start: 0, end: 0.25,
        days: [
          "Ngày 1: Từ vựng & Ngữ pháp Chương 15 (Phán đoán でしょう, かもしれない)",
          "Ngày 2: Kanji & Từ vựng Chương 16",
          "Ngày 3: Ngữ pháp Chương 16 (Truyền đạt そうだ, らしい)",
          "Ngày 4: Kanji & Từ vựng Chương 17-18",
          "Ngày 5: Ngữ pháp Chương 17-18 (Trình bày lý do んです, Trông có vẻ そう)",
          "Ngày 6: Kanji, Từ vựng & Ngữ pháp Chương 19 (Tự động từ, Tha động từ)",
          "Ngày 7: Ôn tập Tuần 1 & Làm bài Đọc hiểu"
        ]
      },
      { 
        week: "Tuần 2", title: "Tăng tốc (Chương 20-24)", start: 0.25, end: 0.5,
        days: [
          "Ngày 8: Từ vựng & Ngữ pháp Chương 20 (Mệnh đề bổ nghĩa danh từ)",
          "Ngày 9: Kanji & Từ vựng Chương 21",
          "Ngày 10: Ngữ pháp Chương 21-22 (Danh từ hóa の, Thể Mệnh lệnh/Cấm đoán)",
          "Ngày 11: Kanji & Từ vựng Chương 22-23",
          "Ngày 12: Ngữ pháp Chương 23 (Thể bị động, Thể cho nhận)",
          "Ngày 13: Kanji, Từ vựng & Ngữ pháp Chương 24",
          "Ngày 14: Ôn tập Tuần 2 & Làm Quiz Từ vựng"
        ]
      },
      { 
        week: "Tuần 3", title: "Vượt chướng ngại (Chương 25-29)", start: 0.5, end: 0.75,
        days: [
          "Ngày 15: Từ vựng & Ngữ pháp Chương 25 (Quyết định ことにする, Trạng thái ようになる)",
          "Ngày 16: Kanji & Từ vựng Chương 26",
          "Ngày 17: Ngữ pháp Chương 26-27 (Lời khuyên ほうがいい, Liệt kê たり)",
          "Ngày 18: Kanji & Từ vựng Chương 27-28",
          "Ngày 19: Ngữ pháp Chương 28 (Thể Sai khiến)",
          "Ngày 20: Kanji, Từ vựng & Ngữ pháp Chương 29",
          "Ngày 21: Ôn tập Tuần 3 & Thử sức đề Ngữ pháp"
        ]
      },
      { 
        week: "Tuần 4", title: "Về đích & Luyện đề (Chương 30-33)", start: 0.75, end: 1,
        days: [
          "Ngày 22: Từ vựng & Ngữ pháp Chương 30 (Câu điều kiện たら, と, ば)",
          "Ngày 23: Kanji & Từ vựng Chương 31",
          "Ngày 24: Ngữ pháp Chương 31-32 (Vì/Mặc dù ので, のに)",
          "Ngày 25: Kanji, Từ vựng & Ngữ pháp Chương 33 (Tôn kính/Khiêm nhường ngữ)",
          "Ngày 26: Giải Đề thi thử số 1 (Tính giờ)",
          "Ngày 27: Giải Đề thi thử số 2 (Tính giờ)",
          "Ngày 28: Tổng kết, Phân tích lỗi sai với AI Sensei"
        ]
      }
    ],
    3: [
      { 
        week: "Tháng 1", title: "Xây dựng nền tảng (Chương 15-20)", start: 0, end: 0.33,
        days: [
          "Tuần 1 (Ngày 1-7): Ch.15-16 (Mỗi ngày học 15 từ vựng, 2 Kanji, 1 cấu trúc ngữ pháp)",
          "Tuần 2 (Ngày 8-14): Ch.17-18 (Mỗi ngày học 15 từ vựng, 2 Kanji, 1 cấu trúc ngữ pháp)",
          "Tuần 3 (Ngày 15-21): Ch.19-20 (Mỗi ngày học 15 từ vựng, 2 Kanji, Đọc hiểu bài ngắn)",
          "Tuần 4 (Ngày 22-28): Ôn tập lại 6 chương đầu & Làm bài test Tháng 1"
        ]
      },
      { 
        week: "Tháng 2", title: "Mở rộng cấu trúc (Chương 21-27)", start: 0.33, end: 0.66,
        days: [
          "Tuần 1 (Ngày 29-35): Ch.21-22 (Trọng tâm: Thể mệnh lệnh, Cấm đoán, Danh từ hóa)",
          "Tuần 2 (Ngày 36-42): Ch.23-24 (Trọng tâm: Thể bị động, Cách chia Tự/Tha động từ)",
          "Tuần 3 (Ngày 43-49): Ch.25-26 (Trọng tâm: Quyết định, Thói quen, Thay đổi trạng thái)",
          "Tuần 4 (Ngày 50-56): Ch.27 & Tổng ôn tập Tháng 2"
        ]
      },
      { 
        week: "Tháng 3", title: "Hoàn thiện & Luyện đề (Chương 28-33)", start: 0.66, end: 1,
        days: [
          "Tuần 1 (Ngày 57-63): Ch.28-29 (Trọng tâm: Thể sai khiến, Bị động sai khiến)",
          "Tuần 2 (Ngày 64-70): Ch.30-31 (Trọng tâm: Kính ngữ & Khiêm nhường ngữ cơ bản)",
          "Tuần 3 (Ngày 71-77): Ch.32-33 (Ôn luyện toàn bộ 80 cấu trúc ngữ pháp N4)",
          "Tuần 4 (Ngày 78-84): Giải 4 đề thi thử JLPT N4, bấm giờ làm bài thực tế."
        ]
      }
    ],
    6: [
      { 
        week: "Tháng 1", title: "Bước đệm (Chương 15-17)", start: 0, end: 0.16,
        days: [
          "Ngày 1-10: Hoàn thành Chương 15 (Từ vựng, Kanji, Ngữ pháp phán đoán)",
          "Ngày 11-20: Hoàn thành Chương 16 (Từ vựng, Kanji, Ngữ pháp truyền đạt thông tin)",
          "Ngày 21-30: Hoàn thành Chương 17 & Ôn tập (Ngữ pháp mở lời, Xin phép)"
        ]
      },
      { 
        week: "Tháng 2", title: "Hình thành câu (Chương 18-20)", start: 0.16, end: 0.33,
        days: [
          "Ngày 1-10: Hoàn thành Chương 18 (Từ vựng, Kanji, Đánh giá trạng thái そう)",
          "Ngày 11-20: Hoàn thành Chương 19 (Từ vựng, Kanji, Tự & Tha động từ)",
          "Ngày 21-30: Hoàn thành Chương 20 & Ôn tập (Mệnh đề bổ nghĩa danh từ)"
        ]
      },
      { 
        week: "Tháng 3", title: "Giao tiếp cơ bản (Chương 21-23)", start: 0.33, end: 0.5,
        days: [
          "Ngày 1-10: Hoàn thành Chương 21 (Danh từ hóa bằng の)",
          "Ngày 11-20: Hoàn thành Chương 22 (Thể Mệnh lệnh, Cấm đoán)",
          "Ngày 21-30: Hoàn thành Chương 23 & Ôn tập (Thể bị động, Cấu trúc cho nhận)"
        ]
      },
      { 
        week: "Tháng 4", title: "Diễn đạt tình trạng (Chương 24-27)", start: 0.5, end: 0.66,
        days: [
          "Ngày 1-7: Chương 24 (Dễ/khó, Quá mức)",
          "Ngày 8-15: Chương 25 (Quyết định dự định, Cố gắng làm gì đó)",
          "Ngày 16-23: Chương 26 (Lời khuyên ほうがいい, Liệt kê hành động たり)",
          "Ngày 24-30: Chương 27 & Ôn tập (Hành động tiếc nuối てしまう, Hoàn thành)"
        ]
      },
      { 
        week: "Tháng 5", title: "Thể phức tạp (Chương 28-30)", start: 0.66, end: 0.83,
        days: [
          "Ngày 1-10: Chương 28 (Thể Sai khiến させる)",
          "Ngày 11-20: Chương 29 (Bị động sai khiến)",
          "Ngày 21-30: Chương 30 & Ôn tập (Mẫu câu về thời gian とき, 間に, までに)"
        ]
      },
      { 
        week: "Tháng 6", title: "Kính ngữ & Luyện đề (Chương 31-33)", start: 0.83, end: 1,
        days: [
          "Ngày 1-7: Chương 31-32 (Câu điều kiện たら, と, ば)",
          "Ngày 8-15: Chương 33 (Tôn kính ngữ, Khiêm nhường ngữ)",
          "Ngày 16-22: Ôn tập tổng hợp từ vựng và Kanji toàn khóa",
          "Ngày 23-30: Luyện đề thi thực tế JLPT/NAT-Test và giải thích với AI."
        ]
      }
    ]
  };

  const isPhaseCompleted = (phaseIdx, daysLength) => {
    if (!daysLength) return false;
    for (let i = 0; i < daysLength; i++) {
      if (!progress.dailyTasks?.[`${duration}_${phaseIdx}_${i}`]) return false;
    }
    return true;
  };

  const togglePhase = (e, phaseIdx, daysLength) => {
    e.stopPropagation(); // Ngăn việc expand card
    const currentlyCompleted = isPhaseCompleted(phaseIdx, daysLength);
    const newTasks = { ...progress.dailyTasks };
    
    // Nếu phase chưa hoàn thành, thì check all. Nếu đã hoàn thành, thì uncheck all.
    for (let i = 0; i < daysLength; i++) {
      newTasks[`${duration}_${phaseIdx}_${i}`] = !currentlyCompleted;
    }
    setProgress(prev => ({ ...prev, dailyTasks: newTasks }));
  };

  const toggleDayTask = (e, phaseIdx, dayIdx) => {
    e.stopPropagation();
    const key = `${duration}_${phaseIdx}_${dayIdx}`;
    setProgress(prev => ({
      ...prev,
      dailyTasks: { ...prev.dailyTasks, [key]: !prev.dailyTasks?.[key] }
    }));
  };

  return (
    <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
      <div className="bg-white p-6 rounded-2xl shadow-sm mb-6 flex flex-col md:flex-row justify-between items-start md:items-center border border-slate-100">
        <div>
          <h2 className="text-3xl font-bold text-slate-800 mb-2">Lộ Trình Học Tập</h2>
          <p className="text-slate-500">Chọn lộ trình và theo dõi công việc mỗi ngày của bạn.</p>
        </div>
        <div className="mt-4 md:mt-0 flex gap-2 bg-slate-100 p-1 rounded-xl">
          {[1, 3, 6].map(m => (
            <button 
              key={m}
              onClick={() => { setDuration(m); setExpandedPhase(0); }}
              className={`px-4 py-2 rounded-lg font-medium transition-colors ${duration === m ? 'bg-white text-red-600 shadow-sm' : 'text-slate-500 hover:bg-slate-200'}`}
            >
              {m} Tháng
            </button>
          ))}
        </div>
      </div>

      <div className="grid gap-6 md:grid-cols-1 lg:grid-cols-2">
        {plans[duration].map((phase, idx) => {
          const totalDays = phase.days.length;
          let completedDays = 0;
          for (let i=0; i<totalDays; i++) {
            if (progress.dailyTasks?.[`${duration}_${idx}_${i}`]) completedDays++;
          }
          const isCompleted = completedDays === totalDays && totalDays > 0;
          const isExpanded = expandedPhase === idx;

          return (
            <div key={idx} className={`bg-white rounded-2xl shadow-sm border transition-all relative overflow-hidden group ${isCompleted ? 'border-emerald-200 bg-emerald-50/20' : 'border-slate-100 hover:shadow-md'}`}>
              {!isCompleted && <div className="absolute top-0 left-0 w-1 h-full bg-red-400"></div>}
              
              {/* Card Header (Bấm để mở rộng) */}
              <div 
                className="p-6 cursor-pointer"
                onClick={() => setExpandedPhase(isExpanded ? null : idx)}
              >
                <div className="flex justify-between items-start mb-3">
                  <div className={`flex items-center gap-3 ${isCompleted ? 'text-emerald-600' : 'text-red-500'}`}>
                    <CalendarDays size={20} />
                    <span className="font-bold text-sm tracking-wider uppercase">{phase.week}</span>
                  </div>
                  <button 
                    onClick={(e) => togglePhase(e, idx, totalDays)}
                    className={`p-1.5 rounded-full transition-colors ${isCompleted ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-100 text-slate-400 hover:bg-emerald-50 hover:text-emerald-500'}`}
                    title={isCompleted ? "Đánh dấu chưa hoàn thành" : "Đánh dấu hoàn thành toàn bộ"}
                  >
                    <CheckCircle2 size={24} />
                  </button>
                </div>
                
                <h3 className={`text-xl font-bold mb-2 ${isCompleted ? 'text-emerald-800' : 'text-slate-800'}`}>{phase.title}</h3>
                <p className="text-slate-600 leading-relaxed mb-4">{phase.desc}</p>
                
                {/* Thanh tiến độ của chặng */}
                <div className="flex items-center gap-3 mb-4">
                  <div className="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
                    <div className="h-full bg-emerald-400 transition-all duration-300" style={{ width: `${(completedDays / totalDays) * 100}%` }}></div>
                  </div>
                  <span className="text-xs font-bold text-slate-400">{completedDays}/{totalDays}</span>
                </div>

                <div className="mt-4 text-center text-slate-400 flex justify-center items-center gap-1 text-sm font-medium">
                  {isExpanded ? (
                    <><ChevronUp size={16}/> Ẩn lịch học từng ngày</>
                  ) : (
                    <><ChevronDown size={16}/> Xem chi tiết từng ngày</>
                  )}
                </div>
              </div>

              {/* Phần mở rộng (Checklist từng ngày kèm Nút Học Ngay) */}
              {isExpanded && (
                <div className="bg-slate-50 border-t border-slate-100 p-4 space-y-3">
                  {phase.days.map((dayText, dIdx) => {
                    const dayDone = progress.dailyTasks?.[`${duration}_${idx}_${dIdx}`];
                    
                    // Tính toán slice dữ liệu cho riêng mục (ngày/tuần) này
                    const blockStart = phase.start + (phase.end - phase.start) * (dIdx / totalDays);
                    const blockEnd = phase.start + (phase.end - phase.start) * ((dIdx + 1) / totalDays);
                    const customTitle = dayText.split(':')[0];

                    const textLower = dayText.toLowerCase();
                    const hasVocab = textLower.includes('từ vựng') || textLower.includes('chương') || textLower.includes('ôn tập');
                    const hasKanji = textLower.includes('kanji') || textLower.includes('chương') || textLower.includes('ôn tập');
                    const hasGrammar = textLower.includes('ngữ pháp') || textLower.includes('chương') || textLower.includes('ôn tập');
                    const hasReading = textLower.includes('đọc hiểu') || textLower.includes('đề') || textLower.includes('test') || textLower.includes('ôn tập');

                    return (
                      <div 
                        key={dIdx} 
                        className={`flex items-start gap-3 p-4 bg-white rounded-xl border transition-colors shadow-sm ${dayDone ? 'border-emerald-200 bg-emerald-50/50' : 'border-slate-100 hover:border-red-200'}`}
                      >
                        <button onClick={(e) => toggleDayTask(e, idx, dIdx)} className="mt-0.5 flex-shrink-0 focus:outline-none transition-transform hover:scale-110">
                          {dayDone ? (
                            <CheckSquare className="text-emerald-500" size={22} />
                          ) : (
                            <Square className="text-slate-300 hover:text-slate-400" size={22} />
                          )}
                        </button>
                        
                        <div className="flex-1">
                          <span 
                            onClick={(e) => toggleDayTask(e, idx, dIdx)} 
                            className={`text-sm font-bold leading-relaxed block cursor-pointer mb-2 transition-colors ${dayDone ? 'text-slate-400 line-through' : 'text-slate-700 hover:text-red-500'}`}
                          >
                            {dayText}
                          </span>
                          
                          {/* Nút hành động vào học ngay của từng ngày */}
                          <div className={`flex flex-wrap gap-2 transition-opacity duration-300 ${dayDone ? 'opacity-50 hover:opacity-100' : 'opacity-100'}`}>
                            {hasVocab && (
                              <button onClick={() => onNavigate('vocab', {start: blockStart, end: blockEnd}, customTitle)} className="text-xs px-2.5 py-1.5 bg-rose-50 hover:bg-rose-500 hover:text-white text-rose-600 rounded-lg transition-all flex items-center gap-1.5 font-semibold">
                                <BookOpen size={14}/> Từ vựng
                              </button>
                            )}
                            {hasKanji && (
                              <button onClick={() => onNavigate('kanji', {start: blockStart, end: blockEnd}, customTitle)} className="text-xs px-2.5 py-1.5 bg-orange-50 hover:bg-orange-500 hover:text-white text-orange-600 rounded-lg transition-all flex items-center gap-1.5 font-semibold">
                                <PenTool size={14}/> Kanji
                              </button>
                            )}
                            {hasGrammar && (
                              <button onClick={() => onNavigate('grammar', {start: blockStart, end: blockEnd}, customTitle)} className="text-xs px-2.5 py-1.5 bg-indigo-50 hover:bg-indigo-500 hover:text-white text-indigo-600 rounded-lg transition-all flex items-center gap-1.5 font-semibold">
                                <Type size={14}/> Ngữ pháp
                              </button>
                            )}
                            {hasReading && (
                              <button onClick={() => onNavigate('reading', null, customTitle)} className="text-xs px-2.5 py-1.5 bg-emerald-50 hover:bg-emerald-500 hover:text-white text-emerald-600 rounded-lg transition-all flex items-center gap-1.5 font-semibold">
                                <AlignLeft size={14}/> Luyện Đọc
                              </button>
                            )}
                          </div>
                        </div>
                      </div>
                    )
                  })}
                </div>
              )}
            </div>
          )
        })}
      </div>
    </div>
  );
}

/* =========================================
   TAB: TỪ VỰNG (VOCABULARY - FLASHCARD/QUIZ)
   ========================================= */
function VocabTab({ progress, setProgress, slice, customTitle }) {
  const [mode, setMode] = useState('flashcard'); // flashcard, quiz

  const displayData = slice 
    ? vocabData.slice(Math.floor(slice.start * vocabData.length), Math.floor(slice.end * vocabData.length)) 
    : vocabData;

  // Handle case where slice is too small
  const safeData = displayData.length > 0 ? displayData : vocabData;

  return (
    <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
      <div className="flex flex-col md:flex-row justify-between items-start md:items-end mb-6 gap-4">
        <div>
          <h2 className="text-3xl font-bold text-slate-800">{customTitle ? `Từ Vựng: ${customTitle}` : 'Từ Vựng N4 (Kho Tổng)'}</h2>
          <p className="text-slate-500 mt-1">Ôn tập bằng Flashcard hoặc kiểm tra với Quiz. ({safeData.length} từ)</p>
        </div>
        <div className="bg-slate-200 p-1 rounded-xl flex">
          <button 
            onClick={() => setMode('flashcard')}
            className={`px-4 py-2 rounded-lg font-medium text-sm transition-all ${mode === 'flashcard' ? 'bg-white shadow-sm text-red-600' : 'text-slate-500'}`}
          >
            Flashcard
          </button>
          <button 
            onClick={() => setMode('quiz')}
            className={`px-4 py-2 rounded-lg font-medium text-sm transition-all ${mode === 'quiz' ? 'bg-white shadow-sm text-red-600' : 'text-slate-500'}`}
          >
            Quiz Review
          </button>
        </div>
      </div>

      {mode === 'flashcard' ? <Flashcards data={safeData} /> : <VocabQuiz data={safeData} progress={progress} setProgress={setProgress} isFiltered={!!slice} />}
    </div>
  );
}

function Flashcards({ data }) {
  const [currentIndex, setCurrentIndex] = useState(0);
  const [isFlipped, setIsFlipped] = useState(false);

  const nextCard = () => {
    setIsFlipped(false);
    setTimeout(() => setCurrentIndex((prev) => (prev + 1) % data.length), 150);
  };
  const prevCard = () => {
    setIsFlipped(false);
    setTimeout(() => setCurrentIndex((prev) => (prev === 0 ? data.length - 1 : prev - 1)), 150);
  };

  const card = data[currentIndex];

  return (
    <div className="flex flex-col items-center max-w-xl mx-auto mt-10">
      <div className="mb-4 text-slate-500 font-medium">Card {currentIndex + 1} / {data.length}</div>
      
      {/* Card Element */}
      <div 
        className="w-full h-80 bg-transparent cursor-pointer group [perspective:1000px]"
        onClick={() => setIsFlipped(!isFlipped)}
      >
        <div className={`relative w-full h-full transition-transform duration-500 [transform-style:preserve-3d] shadow-xl rounded-3xl ${isFlipped ? '[transform:rotateY(180deg)]' : ''}`}>
          
          {/* Front */}
          <div className="absolute w-full h-full [backface-visibility:hidden] bg-white border-2 border-slate-100 rounded-3xl flex flex-col items-center justify-center p-8 text-center hover:border-red-200 transition-colors">
            <span className="text-slate-400 text-sm mb-4 border border-slate-200 px-3 py-1 rounded-full">{card.type}</span>
            <h3 className="text-7xl font-bold text-slate-800 mb-2">{card.kanji}</h3>
            <p className="text-slate-400 mt-6 flex items-center gap-2"><RotateCcw size={16}/> Chạm để lật</p>
          </div>

          {/* Back */}
          <div className="absolute w-full h-full [backface-visibility:hidden] bg-red-50 border-2 border-red-100 rounded-3xl flex flex-col items-center justify-center p-8 text-center [transform:rotateY(180deg)]">
            <h4 className="text-3xl font-semibold text-red-500 mb-2">{card.kana}</h4>
            <div className="w-16 h-1 bg-red-200 rounded-full my-4"></div>
            <p className="text-2xl text-slate-700">{card.meaning}</p>
          </div>
        </div>
      </div>

      {/* Controls */}
      <div className="flex items-center gap-6 mt-10">
        <button onClick={prevCard} className="p-4 bg-white shadow-sm rounded-full hover:bg-slate-50 hover:scale-105 transition-all text-slate-600">
          <ChevronLeft size={24}/>
        </button>
        <button onClick={() => setIsFlipped(!isFlipped)} className="px-8 py-3 bg-red-500 text-white rounded-xl shadow-lg shadow-red-500/30 hover:bg-red-600 transition-all font-bold tracking-wide">
          LẬT THẺ
        </button>
        <button onClick={nextCard} className="p-4 bg-white shadow-sm rounded-full hover:bg-slate-50 hover:scale-105 transition-all text-slate-600">
          <ChevronRight size={24}/>
        </button>
      </div>
    </div>
  );
}

function VocabQuiz({ data, progress, setProgress, isFiltered }) {
  const [qIndex, setQIndex] = useState(0);
  const [score, setScore] = useState(0);
  const [showResult, setShowResult] = useState(false);
  const [selectedAns, setSelectedAns] = useState(null);
  const [newMasteredCount, setNewMasteredCount] = useState(0);

  const currentQ = data[qIndex];
  
  // Generate random options
  const [options, setOptions] = useState([]);
  useEffect(() => {
    if (!showResult && currentQ) {
      let answers = [currentQ.meaning];
      while(answers.length < 4) {
        // Sử dụng vocabData tổng để lấy đáp án ngẫu nhiên, tránh lỗi lặp vô hạn khi mảng data (slice) có ít hơn 4 từ
        let rand = vocabData[Math.floor(Math.random() * vocabData.length)].meaning;
        if (!answers.includes(rand)) answers.push(rand);
      }
      setOptions(answers.sort(() => Math.random() - 0.5));
      setSelectedAns(null);
    }
  }, [qIndex, currentQ, data, showResult]);

  const handleAnswer = (ans) => {
    if (selectedAns) return; // Prevent multiple clicks
    setSelectedAns(ans);
    if (ans === currentQ.meaning) {
      setScore(score + 1);
      
      // Ghi nhận từ vựng đã thuộc vào tiến độ chung
      if (!progress.vocabMastered?.includes(currentQ.kanji)) {
        setNewMasteredCount(prev => prev + 1);
        setProgress(prev => {
          const newSet = new Set(prev.vocabMastered || []);
          newSet.add(currentQ.kanji);
          return { ...prev, vocabMastered: Array.from(newSet) };
        });
      }
    }
    
    setTimeout(() => {
      if (qIndex < data.length - 1) {
        setQIndex(qIndex + 1);
      } else {
        setShowResult(true);
      }
    }, 1000);
  };

  const restart = () => {
    setQIndex(0); setScore(0); setShowResult(false); setSelectedAns(null); setNewMasteredCount(0);
  };

  if (showResult) {
    return (
      <div className="bg-white p-10 rounded-3xl shadow-sm border border-slate-100 text-center max-w-xl mx-auto mt-10 relative overflow-hidden">
        {newMasteredCount > 0 && (
          <div className="absolute top-0 left-0 w-full bg-emerald-400 text-emerald-900 py-2 font-bold flex items-center justify-center gap-2">
            <Trophy size={18} /> Chúc mừng! Bạn vừa thuộc thêm {newMasteredCount} từ vựng mới.
          </div>
        )}
        <h3 className="text-2xl font-bold text-slate-800 mb-4 mt-6">Kết Quả Bài Test</h3>
        <div className="text-6xl font-black text-red-500 mb-6">{score} / {data.length}</div>
        <p className="text-slate-600 mb-8">{score > (data.length / 2) ? 'Tuyệt vời! Bạn nắm từ vựng rất chắc.' : 'Hãy ôn tập thêm bằng Flashcard nhé!'}</p>
        <button onClick={restart} className="bg-slate-800 text-white px-8 py-3 rounded-xl font-bold hover:bg-slate-700 transition-colors">
          Làm Lại
        </button>
      </div>
    );
  }

  return (
    <div className="max-w-2xl mx-auto mt-6">
      <div className="flex justify-between items-center mb-6">
        <span className="text-slate-500 font-medium">Câu hỏi {qIndex + 1}/{data.length}</span>
        <span className="bg-red-100 text-red-600 px-3 py-1 rounded-lg font-bold text-sm">Điểm: {score}</span>
      </div>

      <div className="bg-white p-12 rounded-3xl shadow-sm border border-slate-100 text-center mb-6">
        <div className="text-slate-400 mb-2">{currentQ.type}</div>
        <h2 className="text-6xl font-bold text-slate-800 mb-2">{currentQ.kanji}</h2>
        <p className="text-xl text-slate-500">({currentQ.kana})</p>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        {options.map((opt, i) => {
          let btnClass = "bg-white border-2 border-slate-100 hover:border-red-300 text-slate-700 p-4 rounded-xl text-lg font-medium transition-all text-left";
          if (selectedAns) {
            if (opt === currentQ.meaning) btnClass = "bg-emerald-50 border-2 border-emerald-400 text-emerald-700 p-4 rounded-xl text-lg font-medium text-left";
            else if (opt === selectedAns) btnClass = "bg-red-50 border-2 border-red-400 text-red-700 p-4 rounded-xl text-lg font-medium text-left";
            else btnClass = "bg-slate-50 border-2 border-slate-100 text-slate-400 p-4 rounded-xl text-lg font-medium text-left opacity-50";
          }

          return (
            <button key={i} onClick={() => handleAnswer(opt)} className={btnClass} disabled={!!selectedAns}>
              {opt}
            </button>
          )
        })}
      </div>
    </div>
  );
}

/* =========================================
   TAB: KANJI (SRS / MNEMONICS)
   ========================================= */
function KanjiTab({ progress, setProgress, slice, customTitle }) {
  const displayData = slice 
    ? kanjiData.slice(Math.floor(slice.start * kanjiData.length), Math.floor(slice.end * kanjiData.length)) 
    : kanjiData;
  const safeData = displayData.length > 0 ? displayData : kanjiData;

  const [selectedKanji, setSelectedKanji] = useState(safeData[0]);

  // Reset selection if data changes
  useEffect(() => {
    setSelectedKanji(safeData[0]);
  }, [slice]);

  const isMastered = progress.kanjiMastered.includes(selectedKanji.kanji);

  const handleSRS = (mastered) => {
    setProgress(prev => {
      const newSet = new Set(prev.kanjiMastered);
      if (mastered) newSet.add(selectedKanji.kanji);
      else newSet.delete(selectedKanji.kanji);
      return { ...prev, kanjiMastered: Array.from(newSet) };
    });
  };

  const renderExamplesWithFurigana = (text) => {
    if (!text) return null;
    return text.split(', ').map((item, index) => {
      const regex = /([^\[]+)\[([^\]]+)\]\s*(\(.*\))/;
      const match = item.match(regex);
      if (match) {
        return (
          <span key={index} className="inline-block mr-3 mb-2 bg-white border border-slate-200 px-3 py-1.5 rounded-xl shadow-sm">
            <ruby className="font-bold text-slate-800 text-lg mr-1">
              {match[1]}
              <rt className="text-red-500 text-[10px] tracking-tighter">{match[2]}</rt>
            </ruby>
            <span className="text-slate-600 text-sm">{match[3]}</span>
          </span>
        );
      }
      return <span key={index} className="inline-block mr-3 mb-2 bg-white border border-slate-200 px-3 py-1.5 rounded-xl shadow-sm text-slate-700">{item}</span>;
    });
  };

  return (
    <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
      <div className="mb-6">
        <h2 className="text-3xl font-bold text-slate-800">{customTitle ? `Kanji: ${customTitle}` : 'Kanji N4 (Kho Tổng)'}</h2>
        <p className="text-slate-500 mt-1">Kết hợp gợi ý nhớ (Mnemonics) và đánh giá tiến độ (SRS). ({safeData.length} chữ)</p>
      </div>

      <div className="flex flex-col md:flex-row gap-6">
        {/* List */}
        <div className="md:w-1/3 bg-white p-4 rounded-2xl shadow-sm border border-slate-100 h-fit max-h-[600px] overflow-y-auto">
          <div className="grid grid-cols-5 md:grid-cols-3 gap-2">
            {safeData.map((k, idx) => {
              const mastered = progress.kanjiMastered.includes(k.kanji);
              return (
                <button 
                  key={idx} 
                  onClick={() => setSelectedKanji(k)}
                  className={`aspect-square relative flex items-center justify-center text-2xl font-bold rounded-xl transition-all
                    ${selectedKanji.kanji === k.kanji ? 'bg-red-500 text-white shadow-md' : 'bg-slate-50 text-slate-700 hover:bg-slate-200'}`}
                >
                  {mastered && <CheckCircle size={12} className={`absolute top-1 right-1 ${selectedKanji.kanji === k.kanji ? 'text-white' : 'text-emerald-500'}`} />}
                  {k.kanji}
                </button>
              )
            })}
          </div>
        </div>

        {/* Detail Panel */}
        <div className="md:w-2/3 bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden flex flex-col relative">
          {isMastered && (
            <div className="absolute top-4 right-4 bg-emerald-500 text-white px-3 py-1.5 rounded-full font-bold text-sm flex items-center gap-1 shadow-md z-10">
              <Trophy size={16} /> Đã thuộc
            </div>
          )}
          <div className="bg-slate-800 p-8 text-center text-white flex-shrink-0">
            <h2 className="text-8xl font-black mb-4 drop-shadow-md">{selectedKanji.kanji}</h2>
            <p className="text-xl font-medium tracking-widest uppercase text-slate-300">{selectedKanji.meaning}</p>
          </div>
          
          <div className="p-8 flex-1 flex flex-col justify-between">
            <div>
              <div className="grid grid-cols-2 gap-4 mb-6">
                <div className="bg-slate-50 p-4 rounded-xl">
                  <p className="text-xs text-slate-500 font-bold mb-1 uppercase tracking-wider">Onyomi (Âm On)</p>
                  <p className="text-lg font-medium text-slate-800">{selectedKanji.onyomi}</p>
                </div>
                <div className="bg-slate-50 p-4 rounded-xl">
                  <p className="text-xs text-slate-500 font-bold mb-1 uppercase tracking-wider">Kunyomi (Âm Kun)</p>
                  <p className="text-lg font-medium text-slate-800">{selectedKanji.kunyomi}</p>
                </div>
              </div>

              <div className="mb-6 bg-slate-50 p-4 rounded-xl border border-slate-100">
                <p className="text-sm text-slate-500 font-bold mb-3 uppercase tracking-wider">Từ ví dụ</p>
                <div className="flex flex-wrap">
                  {renderExamplesWithFurigana(selectedKanji.examples)}
                </div>
              </div>

              <div className="bg-amber-50 border border-amber-200 p-4 rounded-xl mb-6">
                <div className="flex items-center gap-2 text-amber-700 font-bold mb-2">
                  <Lightbulb size={18} />
                  <span>Gợi ý nhớ (Mnemonic)</span>
                </div>
                <p className="text-amber-900 leading-relaxed">{selectedKanji.mnemonic}</p>
              </div>
            </div>

            {/* Simulated SRS Buttons */}
            <div>
              <p className="text-center text-xs text-slate-400 mb-3 uppercase tracking-wider font-bold">Mức độ ghi nhớ của bạn</p>
              <div className="flex gap-2">
                <button onClick={() => handleSRS(false)} className="flex-1 py-3 bg-rose-50 hover:bg-rose-100 text-rose-700 font-bold rounded-xl transition-colors border border-rose-200">Lại từ đầu</button>
                <button onClick={() => handleSRS(false)} className="flex-1 py-3 bg-orange-50 hover:bg-orange-100 text-orange-700 font-bold rounded-xl transition-colors border border-orange-200">Khó</button>
                <button onClick={() => handleSRS(true)} className="flex-1 py-3 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 font-bold rounded-xl transition-colors border border-emerald-200">Tốt</button>
                <button onClick={() => handleSRS(true)} className="flex-1 py-3 bg-blue-50 hover:bg-blue-100 text-blue-700 font-bold rounded-xl transition-colors border border-blue-200">Dễ</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

/* =========================================
   TAB: NGỮ PHÁP (GRAMMAR)
   ========================================= */
function GrammarTab({ progress, setProgress, openChatWithPrompt, slice, customTitle }) {
  const displayData = slice 
    ? grammarData.slice(Math.floor(slice.start * grammarData.length), Math.floor(slice.end * grammarData.length)) 
    : grammarData;
  const safeData = displayData.length > 0 ? displayData : grammarData;

  const toggleGrammar = (structure) => {
    setProgress(prev => {
      const newSet = new Set(prev.grammarMastered || []);
      if (newSet.has(structure)) {
        newSet.delete(structure);
      } else {
        newSet.add(structure);
      }
      return { ...prev, grammarMastered: Array.from(newSet) };
    });
  };

  return (
    <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
      <div className="mb-6">
        <h2 className="text-3xl font-bold text-slate-800">{customTitle ? `Ngữ pháp: ${customTitle}` : 'Ngữ pháp N4 (Kho Tổng)'}</h2>
        <p className="text-slate-500 mt-1">Nắm chắc cấu trúc, ví dụ và cách giải thích. ({safeData.length} mẫu)</p>
      </div>

      <div className="space-y-6">
        {safeData.map((item, idx) => {
          const isMastered = progress.grammarMastered?.includes(item.structure);
          return (
          <div key={idx} className={`bg-white rounded-2xl shadow-sm border overflow-hidden transition-colors ${isMastered ? 'border-emerald-200' : 'border-slate-100'}`}>
            <div className="bg-slate-800 px-6 py-4 border-b border-slate-100 flex items-center justify-between flex-wrap gap-4">
              <div className="flex items-center gap-3">
                <button 
                  onClick={() => toggleGrammar(item.structure)}
                  className={`transition-colors focus:outline-none flex-shrink-0 ${isMastered ? 'text-emerald-400 hover:text-emerald-300' : 'text-slate-500 hover:text-slate-300'}`}
                  title={isMastered ? "Bỏ đánh dấu" : "Đánh dấu đã học"}
                >
                  <CheckCircle2 size={24} />
                </button>
                <h3 className="text-xl font-bold text-white tracking-wide">{item.structure}</h3>
              </div>
              <span className="bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider">{item.meaning}</span>
            </div>
            <div className="p-6">
              <p className="text-slate-700 leading-relaxed mb-6 bg-slate-50 p-4 rounded-xl border border-slate-100">
                <span className="font-bold text-slate-800 block mb-1">Cách dùng:</span>
                {item.explanation}
              </p>
              
              <div>
                <span className="font-bold text-slate-800 block mb-3">Ví dụ (例文):</span>
                <div className="space-y-4">
                  {item.examples.map((ex, eIdx) => (
                    <div key={eIdx} className="pl-4 border-l-4 border-red-400">
                      <p className="text-lg font-medium text-slate-800 mb-1">{ex.jp}</p>
                      <p className="text-slate-500">{ex.vi}</p>
                    </div>
                  ))}
                </div>
              </div>

              <div className="mt-6 pt-4 border-t border-slate-100 flex justify-end">
                <button 
                  onClick={() => openChatWithPrompt(`Hãy giải thích thật chi tiết và cho thêm 3 ví dụ khác về cấu trúc ngữ pháp N4: "${item.structure}" (${item.meaning})`)}
                  className="flex items-center gap-2 text-indigo-600 bg-indigo-50 hover:bg-indigo-100 px-4 py-2 rounded-xl transition-colors font-medium text-sm"
                >
                  <Sparkles size={16} /> Nhờ AI giải thích thêm
                </button>
              </div>
            </div>
          </div>
          );
        })}
      </div>
    </div>
  );
}

/* =========================================
   TAB: ĐỌC HIỂU (READING)
   ========================================= */
function ReadingTab({ openChatWithPrompt, customTitle }) {
  const [selectedWord, setSelectedWord] = useState(null);

  const textPassage = [
    "来週、日本へ", { w: "旅行" }, "に行きます。",
    "しかし、天気予報によると、", { w: "台風" }, "が来るかもしれません。",
    "もし飛行機が飛ばなかったら、旅行は", { w: "中止" }, "になります。",
    "それはとても", { w: "残念" }, "です。北海道で", { w: "温泉" }, "に入る", { w: "予定" }, "でした。"
  ];

  const handleWordClick = (word) => {
    setSelectedWord(word);
  };

  return (
    <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
      <div className="mb-6">
        <h2 className="text-3xl font-bold text-slate-800">{customTitle ? `Luyện Đọc: ${customTitle}` : 'Luyện tập Đọc hiểu'}</h2>
        <p className="text-slate-500 mt-1">Bấm vào các từ được in đậm để tra nghĩa trực tiếp.</p>
      </div>

      <div className="flex flex-col lg:flex-row gap-6">
        <div className="lg:w-2/3 bg-white p-8 md:p-10 rounded-3xl shadow-sm border border-slate-100 text-lg leading-loose text-slate-800">
          <p className="mb-4 text-slate-400 text-sm font-bold uppercase tracking-wider flex items-center gap-2">
            <BookOpen size={16} /> Bài đọc 1: 計画 (Kế hoạch)
          </p>
          <div className="font-serif">
            {textPassage.map((item, idx) => {
              if (typeof item === 'string') {
                return <span key={idx}>{item}</span>;
              } else {
                return (
                  <span 
                    key={idx} 
                    onClick={() => handleWordClick(item.w)}
                    className="font-bold text-red-600 bg-red-50 px-1 rounded cursor-pointer hover:bg-red-500 hover:text-white transition-colors"
                  >
                    {item.w}
                  </span>
                )
              }
            })}
          </div>
        </div>

        <div className="lg:w-1/3">
          <div className="bg-slate-800 rounded-3xl p-6 text-white sticky top-8 shadow-lg shadow-slate-800/20">
            <h3 className="text-lg font-bold mb-4 flex items-center gap-2 border-b border-slate-600 pb-4">
              <Search size={20} className="text-red-400"/>
              Từ điển nhanh
            </h3>
            
            {selectedWord ? (
              <div className="animate-in slide-in-from-right-4 fade-in duration-300">
                <div className="text-4xl font-black mb-2 text-red-400">{selectedWord}</div>
                <div className="text-xl text-slate-300 mb-6">{readingVocabDict[selectedWord].kana}</div>
                <div className="bg-slate-700/50 p-4 rounded-xl border border-slate-600">
                  <p className="text-sm text-slate-400 mb-1 uppercase tracking-wider font-bold">Nghĩa tiếng Việt</p>
                  <p className="text-lg">{readingVocabDict[selectedWord].meaning}</p>
                </div>
                
                <button 
                  onClick={() => openChatWithPrompt(`Hãy giải thích chi tiết cách dùng, cho thêm ví dụ và các từ đồng nghĩa của từ vựng tiếng Nhật N4: "${selectedWord}" (${readingVocabDict[selectedWord].kana} - ${readingVocabDict[selectedWord].meaning})`)}
                  className="mt-4 w-full flex items-center justify-center gap-2 bg-indigo-500 hover:bg-indigo-600 text-white p-3 rounded-xl transition-colors font-medium text-sm"
                >
                  <Sparkles size={18} /> Phân tích với AI
                </button>
              </div>
            ) : (
              <div className="py-10 text-center opacity-50 flex flex-col items-center">
                <Search size={48} className="mb-4" />
                <p>Bấm vào từ vựng được bôi đỏ trong bài đọc để xem nghĩa.</p>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
}

/* =========================================
   GEMINI AI CHAT COMPONENT
   ========================================= */

async function fetchGemini(prompt, retries = 5, delay = 1000) {
  const apiKey = "";
  const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
  const payload = {
    contents: [{ parts: [{ text: prompt }] }],
    systemInstruction: { parts: [{ text: "Bạn là Sensei, một giáo viên dạy tiếng Nhật JLPT N4 vui tính, tận tâm và chuyên nghiệp. Hãy giải thích ngữ pháp, từ vựng hoặc trả lời các câu hỏi về tiếng Nhật một cách ngắn gọn, dễ hiểu, trình bày đẹp bằng tiếng Việt. Luôn cung cấp furigana cho Kanji." }] }
  };

  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    if (!response.ok) {
      if (response.status === 429 && retries > 0) {
        await new Promise(r => setTimeout(r, delay));
        return fetchGemini(prompt, retries - 1, delay * 2);
      }
      throw new Error('API Error');
    }

    const data = await response.json();
    return data.candidates?.[0]?.content?.parts?.[0]?.text || "Sensei xin lỗi, hiện tại hệ thống đang bận.";
  } catch (error) {
    if (retries > 0) {
      await new Promise(r => setTimeout(r, delay));
      return fetchGemini(prompt, retries - 1, delay * 2);
    }
    return "Sensei xin lỗi, đã có lỗi kết nối. Bạn thử lại sau nhé!";
  }
}

function GeminiChat({ onClose, initialPrompt, clearInitialPrompt }) {
  const [messages, setMessages] = useState([
    { role: 'ai', text: 'Chào bạn! Mình là AI Trợ giảng N4. Bạn có câu hỏi gì về từ vựng, Kanji hay ngữ pháp không?' }
  ]);
  const [input, setInput] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const messagesEndRef = useRef(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  useEffect(() => {
    if (initialPrompt) {
      handleSend(initialPrompt);
      clearInitialPrompt();
    }
  }, [initialPrompt]);

  const handleSend = async (textToSend) => {
    const text = textToSend || input;
    if (!text.trim()) return;

    setInput('');
    setMessages(prev => [...prev, { role: 'user', text }]);
    setIsLoading(true);

    const aiResponse = await fetchGemini(text);
    
    setMessages(prev => [...prev, { role: 'ai', text: aiResponse }]);
    setIsLoading(false);
  };

  return (
    <div className="fixed bottom-24 right-6 w-[340px] md:w-96 h-[500px] max-h-[80vh] bg-white rounded-3xl shadow-2xl border border-slate-100 flex flex-col overflow-hidden z-50 animate-in slide-in-from-bottom-8 fade-in duration-300">
      {/* Header */}
      <div className="bg-indigo-600 text-white p-4 flex justify-between items-center shrink-0">
        <div className="flex items-center gap-2">
          <Bot size={24} />
          <h3 className="font-bold text-lg">AI Trợ Giảng N4</h3>
        </div>
        <button onClick={onClose} className="text-indigo-200 hover:text-white transition-colors">
          <X size={24} />
        </button>
      </div>

      {/* Chat Body */}
      <div className="flex-1 p-4 overflow-y-auto bg-slate-50 space-y-4">
        {messages.map((msg, idx) => (
          <div key={idx} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
            <div className={`max-w-[85%] p-3 rounded-2xl text-sm leading-relaxed ${
              msg.role === 'user' 
                ? 'bg-indigo-600 text-white rounded-tr-sm' 
                : 'bg-white border border-slate-200 text-slate-700 rounded-tl-sm shadow-sm whitespace-pre-wrap'
            }`}>
              {msg.text}
            </div>
          </div>
        ))}
        {isLoading && (
          <div className="flex justify-start">
            <div className="bg-white border border-slate-200 text-slate-700 p-3 rounded-2xl rounded-tl-sm shadow-sm flex items-center gap-2">
              <Loader2 size={16} className="animate-spin text-indigo-500" />
              <span className="text-sm">Sensei đang gõ...</span>
            </div>
          </div>
        )}
        <div ref={messagesEndRef} className="h-px" />
      </div>

      {/* Input Area */}
      <div className="p-3 bg-white border-t border-slate-100 flex items-end gap-2 shrink-0">
        <textarea 
          value={input}
          onChange={(e) => setInput(e.target.value)}
          onKeyDown={(e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
              e.preventDefault(); // Ngăn xuống dòng khi chỉ bấm Enter
              handleSend();
            }
          }}
          placeholder="Hỏi AI (Shift+Enter để xuống dòng)..."
          className="flex-1 bg-slate-100 border-none px-4 py-3 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50 resize-none"
          rows={2}
        />
        <button 
          onClick={() => handleSend()}
          disabled={isLoading || !input.trim()}
          className="h-10 w-10 mb-0.5 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shrink-0"
        >
          <Send size={18} />
        </button>
      </div>
    </div>
  );
}
